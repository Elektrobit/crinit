<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../../_static/favicon_16x16.png" sizes="16x16" rel="icon" type="image/png">
    <link href="../../_static/favicon_32x32.png" sizes="32x32" rel="icon" type="image/png">
    <title>Architecture Design Record - Storage scheme for file signatures &#8212; crinit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Architecture Design Record - INCLUDE file options" href="adr-task-include-strategy.html" />
    <link rel="prev" title="Architecture Design Record - Configuration interface for signature handling" href="adr-signature-conf-interface.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="architecture-design-record-storage-scheme-for-file-signatures">
<h1>Architecture Design Record - Storage scheme for file signatures<a class="headerlink" href="#architecture-design-record-storage-scheme-for-file-signatures" title="Link to this heading">¶</a></h1>
<section id="problem">
<h2>Problem<a class="headerlink" href="#problem" title="Link to this heading">¶</a></h2>
<p>As Crinit shall support configuration file signatures, we need to decide how to store them.</p>
</section>
<section id="assumption">
<h2>Assumption<a class="headerlink" href="#assumption" title="Link to this heading">¶</a></h2>
<p>As described in <a class="reference internal" href="adr-pubkey-storage.html"><span class="std std-doc">Storage scheme for public keys</span></a> the root key to verify is stored in the kernel
key ring and further keys (signed/verified by the root key) are stored in the filesystem.</p>
<p>The root key may be identified by a keyID configurable via the Kernel command line. All trusted keys including the root
key are used to verify the signatures described here. There is no keyID used to identify the key needed to verify a
particular signature.</p>
<p>Reason why this does not consume too many cpu cycles:</p>
<ul class="simple">
<li><p>the hash (SHA256) of the data to be verified is calculated only once</p></li>
<li><p>all data is in RAM (key in keyring and hash mentioned above)</p></li>
<li><p>far less than 100 keys are expected to be loaded to the key ring</p></li>
</ul>
</section>
<section id="considered-alternatives">
<h2>Considered Alternatives<a class="headerlink" href="#considered-alternatives" title="Link to this heading">¶</a></h2>
<section id="option-1-within-the-configuration-file">
<h3>Option 1 - Within the configuration file<a class="headerlink" href="#option-1-within-the-configuration-file" title="Link to this heading">¶</a></h3>
<p>The signature is stored as ASCII plaintext (using uuencode or similar) and appended to the file it is signing.</p>
<section id="pros">
<h4>Pros<a class="headerlink" href="#pros" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>easy and clear association between signature and file</p></li>
</ul>
</section>
<section id="cons">
<h4>Cons<a class="headerlink" href="#cons" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>file is necessarily changed after being signed, verification slightly more complex</p></li>
<li><p>may look confusing to users</p></li>
</ul>
</section>
</section>
<section id="option-2-separate-file-associated-by-name">
<h3>Option 2 - Separate file associated by name<a class="headerlink" href="#option-2-separate-file-associated-by-name" title="Link to this heading">¶</a></h3>
<p>The signature is stored in either ASCII or binary format and placed in its own file. A config file <code class="docutils literal notranslate"><span class="pre">some_task.crinit</span></code>
would have a corresponding <code class="docutils literal notranslate"><span class="pre">some_task.sig</span></code> signature file. The signature file should be placed in the same path as the
configuration file.</p>
<section id="id1">
<h4>Pros<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>easy and clear association between signature and file</p></li>
<li><p>easy verification</p></li>
<li><p>the configuration file is not touched in the process</p></li>
<li><p>meshes well with existing configuration “style”</p></li>
</ul>
</section>
<section id="id2">
<h4>Cons<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>it may not be immediately apparent to the user that a given file has a signature</p></li>
</ul>
</section>
</section>
<section id="option-3-separate-file-associated-by-configurable-path">
<h3>Option 3 - Separate file associated by configurable path<a class="headerlink" href="#option-3-separate-file-associated-by-configurable-path" title="Link to this heading">¶</a></h3>
<p>Similar to option 2, but the configuration file contains a path to the signature file which may be arbitrarily named,
like <code class="docutils literal notranslate"><span class="pre">SIGNATURE</span> <span class="pre">=</span> <span class="pre">/path/to/signature.sig</span></code>.</p>
<section id="id3">
<h4>Pros<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>flexible</p></li>
<li><p>easy to see if a given configuration has a linked signature</p></li>
</ul>
</section>
<section id="id4">
<h4>Cons<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>configuration file needs to be changed during signing</p></li>
<li><p>more complex verification</p></li>
<li><p>difference to configuration “style” of rest of crinit</p></li>
</ul>
</section>
</section>
</section>
<section id="decision">
<h2>Decision<a class="headerlink" href="#decision" title="Link to this heading">¶</a></h2>
<p>Option 2 is taken.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/crinit-logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">crinit</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../README.html">Crinit – Configurable Rootfs Init</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../README.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../README.html#details">Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../API-Doc.html">Public API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src/index.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts/README.html">Crinit-related scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts/README.html#script-usage-information">Script usage information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts/README.html#usage-examples">Usage examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts/README.html#note-on-the-key-type-used-in-crinit-genkeys-sh">Note on the key type used in <code class="docutils literal notranslate"><span class="pre">crinit-genkeys.sh</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../test/README.html">Tests</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ADRS</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#list-of-adrs">List of ADRs</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Architecture Design Records</a><ul>
      <li>Previous: <a href="adr-signature-conf-interface.html" title="previous chapter">Architecture Design Record - Configuration interface for signature handling</a></li>
      <li>Next: <a href="adr-task-include-strategy.html" title="next chapter">Architecture Design Record - INCLUDE file options</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, emlix GmbH/Elektrobit Automotive GmbH.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/doc/adr/adr-signature-storage.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>