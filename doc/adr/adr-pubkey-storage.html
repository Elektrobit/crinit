<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../../_static/favicon_16x16.png" sizes="16x16" rel="icon" type="image/png">
    <link href="../../_static/favicon_32x32.png" sizes="32x32" rel="icon" type="image/png">
    <title>Architecture Design Record - Storage scheme for public keys &#8212; crinit  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Architecture Design Record - Choice of signature algorithm for signed configurations" href="adr-signature-algorithm.html" />
    <link rel="prev" title="Architecture Design Record - Management of named pipes for IO redirection" href="adr-pipe-redirection.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="architecture-design-record-storage-scheme-for-public-keys">
<h1>Architecture Design Record - Storage scheme for public keys<a class="headerlink" href="#architecture-design-record-storage-scheme-for-public-keys" title="Link to this heading">¶</a></h1>
<section id="problem">
<h2>Problem<a class="headerlink" href="#problem" title="Link to this heading">¶</a></h2>
<p>In order to support signatures, crinit needs to keep track of one or more public keys. These should be protected from
tampering to ensure authenticity of signatures.</p>
</section>
<section id="influencing-factors">
<h2>Influencing Factors<a class="headerlink" href="#influencing-factors" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Multiple trusted vendors of crinit files may exist.</p></li>
</ul>
</section>
<section id="assumptions">
<h2>Assumptions<a class="headerlink" href="#assumptions" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Signatures are always used in conjunction with some secure boot scheme, i.e. everything up to the Kernel binary, Device-tree (dtb) and initram-disk can
be considered trusted by crinit.</p></li>
</ul>
</section>
<section id="considered-alternatives">
<h2>Considered Alternatives<a class="headerlink" href="#considered-alternatives" title="Link to this heading">¶</a></h2>
<section id="option-1-key-directory-in-rootfs">
<h3>Option 1 - Key directory in rootfs<a class="headerlink" href="#option-1-key-directory-in-rootfs" title="Link to this heading">¶</a></h3>
<p>A number of plain public keys exist in a known directory of the rootfs. If a crinit config is signed with one of them,
it is considered trusted.</p>
<section id="pros">
<h4>Pros<a class="headerlink" href="#pros" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>easy implementation</p></li>
<li><p>easy to add new keys by third party</p></li>
</ul>
</section>
<section id="cons">
<h4>Cons<a class="headerlink" href="#cons" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>only trustworthy if rootfs itself is trusted, i.e. signed as a whole</p>
<ul>
<li><p>this mostly defeats the purpose of having individually signed files in the first place as even individually unsigned
configs could be considered trustworthy by their presence in the already completely signed rootfs.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="option-2-keys-in-system-keyring">
<h3>Option 2 - Keys in system keyring<a class="headerlink" href="#option-2-keys-in-system-keyring" title="Link to this heading">¶</a></h3>
<p>A number of public keys are available via the system keyring (in-kernel key management and retention facility, man 7 keyrings). If a crinit config is signed with one of them, it is
considered trusted.</p>
<p>The method to load the keys to the system keyring must be protected by the secure boot chain. The means to do that are implementation defined, possible examples could be:</p>
<ul class="simple">
<li><p>compilation into a signed Kernel</p></li>
<li><p>Kernel support for a hardware security module containing the key</p></li>
<li><p>a trusted Kernel module</p></li>
</ul>
<section id="id1">
<h4>Pros<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>trustworthy and tamper-proof in conjunction with secure boot</p></li>
</ul>
</section>
<section id="id2">
<h4>Cons<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>hard to add new keys by third party</p></li>
</ul>
</section>
</section>
<section id="option-3-master-key-in-system-keyring-signed-keys-in-rootfs-key-directory">
<h3>Option 3 - Master key in system keyring, signed keys in rootfs key directory<a class="headerlink" href="#option-3-master-key-in-system-keyring-signed-keys-in-rootfs-key-directory" title="Link to this heading">¶</a></h3>
<p>A master public key is available via the Kernel system keyring. A number of public keys which are signed with the master
private key exist in a known directory of the rootfs. If a crinit config is signed with one of them or the master key,
it is considered trusted.</p>
<p>The method to load the master key are similar to option 2.</p>
<section id="id3">
<h4>Pros<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>trustworthy and tamper-proof in conjunction with secure boot</p></li>
<li><p>reasonably easy to add new third-party keys</p></li>
</ul>
</section>
<section id="id4">
<h4>Cons<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>a change of master key needs not only a new Kernel but also an update to rootfs</p></li>
</ul>
</section>
</section>
</section>
<section id="decision">
<h2>Decision<a class="headerlink" href="#decision" title="Link to this heading">¶</a></h2>
<p>Option 3 is taken.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/crinit-logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">crinit</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../README.html">Crinit – Configurable Rootfs Init</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../README.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../README.html#details">Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../API-Doc.html">Public API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../src/index.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts/README.html">Crinit-related scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts/README.html#script-usage-information">Script usage information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts/README.html#usage-examples">Usage examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts/README.html#note-on-the-key-type-used-in-crinit-genkeys-sh">Note on the key type used in <code class="docutils literal notranslate"><span class="pre">crinit-genkeys.sh</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../test/README.html">Tests</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ADRS</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#list-of-adrs">List of ADRs</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Architecture Design Records</a><ul>
      <li>Previous: <a href="adr-pipe-redirection.html" title="previous chapter">Architecture Design Record - Management of named pipes for IO redirection</a></li>
      <li>Next: <a href="adr-signature-algorithm.html" title="next chapter">Architecture Design Record - Choice of signature algorithm for signed configurations</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, emlix GmbH/Elektrobit Automotive GmbH.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/doc/adr/adr-pubkey-storage.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>