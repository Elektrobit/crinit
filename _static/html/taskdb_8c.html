<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Crinit -- Configurable Rootfs Init: src/taskdb.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Crinit -- Configurable Rootfs Init
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('taskdb_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">taskdb.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<h3 class="version">(2023-08-28, commit: 649e63b)</h3>
<p>Implementation of the central Task Database and related functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="taskdb_8h_source.html">taskdb.h</a>&quot;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="common_8h_source.html">common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="globopt_8h_source.html">globopt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="logio_8h_source.html">logio.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="optfeat_8h_source.html">optfeat.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for taskdb.c:</div>
<div class="dyncontent">
<div class="center"><img src="taskdb_8c__incl.png" border="0" usemap="#asrc_2taskdb_8c" alt=""/></div>
<map name="asrc_2taskdb_8c" id="asrc_2taskdb_8c">
<area shape="rect" title="Implementation of the central Task Database and related functions." alt="" coords="503,5,603,32"/>
<area shape="rect" href="taskdb_8h.html" title="Header defining the central Task Data Structure and related types/functions." alt="" coords="166,80,245,107"/>
<area shape="rect" title=" " alt="" coords="127,453,201,480"/>
<area shape="rect" title=" " alt="" coords="647,80,718,107"/>
<area shape="rect" title=" " alt="" coords="482,155,553,181"/>
<area shape="rect" href="common_8h.html" title="Header for common definitions not related to other specific features." alt="" coords="743,80,833,107"/>
<area shape="rect" href="globopt_8h.html" title="Header related to global option storage." alt="" coords="399,80,481,107"/>
<area shape="rect" href="logio_8h.html" title="Header related to debug/log output." alt="" coords="556,80,623,107"/>
<area shape="rect" href="optfeat_8h.html" title="Header related to optional behavior dependent on available system features." alt="" coords="858,80,939,107"/>
<area shape="rect" title=" " alt="" coords="114,155,198,181"/>
<area shape="rect" href="task_8h.html" title="Header defining the data structures belonging to a single task and related functions." alt="" coords="222,155,285,181"/>
<area shape="rect" href="confparse_8h.html" title="Header related to the Config Parser." alt="" coords="224,304,323,331"/>
<area shape="rect" href="crinit-sdefs_8h.html" title="Definitions shared between crinit&#39;s public and internal APIs." alt="" coords="93,304,200,331"/>
<area shape="rect" href="envset_8h.html" title="Header defining data types and functions to work with sets of environment variables." alt="" coords="334,229,413,256"/>
<area shape="rect" href="ioredir_8h.html" title="Header related to IO redirection types and functions." alt="" coords="235,229,309,256"/>
<area shape="rect" title=" " alt="" coords="384,453,467,480"/>
<area shape="rect" title=" " alt="" coords="105,379,201,405"/>
<area shape="rect" href="fseries_8h.html" title="Header defining functions related to the handling of a series of filenames within a directory." alt="" coords="233,379,311,405"/>
<area shape="rect" title=" " alt="" coords="629,155,697,181"/>
<area shape="rect" title=" " alt="" coords="721,155,788,181"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4a19c0a236ef9186f735a6a9677c1591"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a4a19c0a236ef9186f735a6a9677c1591">crinitFindTask</a> (<a class="el" href="structcrinitTask__t.html">crinitTask_t</a> **task, const char *taskName, const <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *in)</td></tr>
<tr class="separator:a4a19c0a236ef9186f735a6a9677c1591"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9e2319b27f35044a7b2c10316f17dea"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#ab9e2319b27f35044a7b2c10316f17dea">crinitTaskIsReady</a> (const <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> *t)</td></tr>
<tr class="separator:ab9e2319b27f35044a7b2c10316f17dea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a201bfdc33630f7b8baf3f90d8ca6d258"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a201bfdc33630f7b8baf3f90d8ca6d258">crinitTaskDBInitWithSize</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, int(*spawnFunc)(<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, const <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> *), size_t initialSize)</td></tr>
<tr class="separator:a201bfdc33630f7b8baf3f90d8ca6d258"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0513aea87118637628ac26c83cd07e00"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a0513aea87118637628ac26c83cd07e00">crinitTaskDBDestroy</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx)</td></tr>
<tr class="separator:a0513aea87118637628ac26c83cd07e00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01bf0221c85ee5a9cbda759e3ffc0612"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a01bf0221c85ee5a9cbda759e3ffc0612">crinitTaskDBInsert</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, const <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> *t, bool overwrite)</td></tr>
<tr class="separator:a01bf0221c85ee5a9cbda759e3ffc0612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9414e5c37b05ee3e74261f98021736c4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a9414e5c37b05ee3e74261f98021736c4">crinitTaskDBSpawnReady</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx)</td></tr>
<tr class="separator:a9414e5c37b05ee3e74261f98021736c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e24830d7fdb34c95c8662e0452f697a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a8e24830d7fdb34c95c8662e0452f697a">crinitTaskDBSetSpawnInhibit</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, bool inh)</td></tr>
<tr class="separator:a8e24830d7fdb34c95c8662e0452f697a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86c7df5aac6ce38969ed52874a887f01"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a86c7df5aac6ce38969ed52874a887f01">crinitTaskDBSetTaskState</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, <a class="el" href="crinit-sdefs_8h.html#a96326334c512388a4528407927f1d770">crinitTaskState_t</a> s, const char *taskName)</td></tr>
<tr class="separator:a86c7df5aac6ce38969ed52874a887f01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e15de21b6b9c5a274eb13285d00f00"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a23e15de21b6b9c5a274eb13285d00f00">crinitTaskDBGetTaskState</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, <a class="el" href="crinit-sdefs_8h.html#a96326334c512388a4528407927f1d770">crinitTaskState_t</a> *s, const char *taskName)</td></tr>
<tr class="separator:a23e15de21b6b9c5a274eb13285d00f00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eef35669a9e906da28cf30e3e8e2317"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a3eef35669a9e906da28cf30e3e8e2317">crinitTaskDBSetTaskPID</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, pid_t pid, const char *taskName)</td></tr>
<tr class="separator:a3eef35669a9e906da28cf30e3e8e2317"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a785eeee1d24013e61aadd00ced97cbac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a785eeee1d24013e61aadd00ced97cbac">crinitTaskDBGetTaskPID</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, pid_t *pid, const char *taskName)</td></tr>
<tr class="separator:a785eeee1d24013e61aadd00ced97cbac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97d880e0b399c6fd9ef7ba90856dde96"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a97d880e0b399c6fd9ef7ba90856dde96">crinitTaskDBGetTaskStateAndPID</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, <a class="el" href="crinit-sdefs_8h.html#a96326334c512388a4528407927f1d770">crinitTaskState_t</a> *s, pid_t *pid, const char *taskName)</td></tr>
<tr class="separator:a97d880e0b399c6fd9ef7ba90856dde96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48b9b0c43103c8709df03307db7b980d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a48b9b0c43103c8709df03307db7b980d">crinitTaskDBAddDepToTask</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, const <a class="el" href="structcrinitTaskDep__t.html">crinitTaskDep_t</a> *dep, const char *taskName)</td></tr>
<tr class="separator:a48b9b0c43103c8709df03307db7b980d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa92d56059fed60ab94db38fed8ddf509"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#aa92d56059fed60ab94db38fed8ddf509">crinitTaskDBRemoveDepFromTask</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, const <a class="el" href="structcrinitTaskDep__t.html">crinitTaskDep_t</a> *dep, const char *taskName)</td></tr>
<tr class="separator:aa92d56059fed60ab94db38fed8ddf509"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4e226b3c756bf1fdb2a45076413927f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#ad4e226b3c756bf1fdb2a45076413927f">crinitTaskDBFulfillDep</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, const <a class="el" href="structcrinitTaskDep__t.html">crinitTaskDep_t</a> *dep, const <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> *target)</td></tr>
<tr class="separator:ad4e226b3c756bf1fdb2a45076413927f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c001c5700abd471f8d7b2144018425d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a7c001c5700abd471f8d7b2144018425d">crinitTaskDBProvideFeature</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, const <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> *provider, <a class="el" href="crinit-sdefs_8h.html#a96326334c512388a4528407927f1d770">crinitTaskState_t</a> newState)</td></tr>
<tr class="separator:a7c001c5700abd471f8d7b2144018425d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5f820ace0d5b55d533d7f846fc1dc15"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#ae5f820ace0d5b55d533d7f846fc1dc15">crinitTaskDBProvideFeatureByTaskName</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, const char *taskName, <a class="el" href="crinit-sdefs_8h.html#a96326334c512388a4528407927f1d770">crinitTaskState_t</a> newState)</td></tr>
<tr class="separator:ae5f820ace0d5b55d533d7f846fc1dc15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39e62e613d875c26844a0b47b468026b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskdb_8c.html#a39e62e613d875c26844a0b47b468026b">crinitTaskDBExportTaskNamesToArray</a> (<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, char **tasks[], size_t *numTasks)</td></tr>
<tr class="separator:a39e62e613d875c26844a0b47b468026b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of the central Task Database and related functions. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a4a19c0a236ef9186f735a6a9677c1591"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a19c0a236ef9186f735a6a9677c1591">&#9670;&nbsp;</a></span>crinitFindTask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int crinitFindTask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTask__t.html">crinitTask_t</a> **&#160;</td>
          <td class="paramname"><em>task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>taskName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Find index of a task in the <a class="el" href="structcrinitTaskDB__t.html#af548ac1ac231221121afa8cde3c14780" title="Dynamic array of tasks, corresponds to task configs specified in the series config.">crinitTaskDB_t::taskSet</a> of an <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> by name.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">task</td><td>Pointer pointer to return the task with. </td></tr>
    <tr><td class="paramname">taskName</td><td>The <a class="el" href="structcrinitTask__t.html#a29602304fb5bb5d58159f9d7747a604e" title="Name of the task, corresponds to NAME in the config file.">crinitTask_t::name</a> to search for. </td></tr>
    <tr><td class="paramname">in</td><td>The crinitTaskDB_t_t to search in.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>

</div>
</div>
<a id="a48b9b0c43103c8709df03307db7b980d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48b9b0c43103c8709df03307db7b980d">&#9670;&nbsp;</a></span>crinitTaskDBAddDepToTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBAddDepToTask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcrinitTaskDep__t.html">crinitTaskDep_t</a> *&#160;</td>
          <td class="paramname"><em>dep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>taskName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a dependency to a specific task inside a task database.</p>
<p>Will search <em>ctx</em> for a task with name <em>taskName</em> and add <em>dep</em> to its <a class="el" href="structcrinitTask__t.html#ade4034f914b448f0cfb4e9249669ab95" title="Dynamic array of dependencies, corresponds to DEPENDS in the config file.">crinitTask_t::deps</a> and adjust <a class="el" href="structcrinitTask__t.html#a577a31bf5e540e93c859e4d3b53ccf67" title="Number of dependencies in deps array.">crinitTask_t::depsSize</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The crinitTaskDb context to work on. </td></tr>
    <tr><td class="paramname">dep</td><td>The dependency to be added. </td></tr>
    <tr><td class="paramname">taskName</td><td>The name of the relevant task.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherweise </dd></dl>

</div>
</div>
<a id="a0513aea87118637628ac26c83cd07e00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0513aea87118637628ac26c83cd07e00">&#9670;&nbsp;</a></span>crinitTaskDBDestroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBDestroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free memory allocated for <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> members by functions like crinitTaskDBInit or <a class="el" href="taskdb_8h.html#a01bf0221c85ee5a9cbda759e3ffc0612">crinitTaskDBInsert()</a>.</p>
<p>Afterwards <em>ctx</em> may not be used anymore until another call to <a class="el" href="taskdb_8h.html#a1a3304f4503181f9ce19c0fe28b344c2">crinitTaskDBInit()</a> or <a class="el" href="taskdb_8h.html#a201bfdc33630f7b8baf3f90d8ca6d258">crinitTaskDBInitWithSize()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> context to be destroyed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on error </dd></dl>

</div>
</div>
<a id="a39e62e613d875c26844a0b47b468026b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39e62e613d875c26844a0b47b468026b">&#9670;&nbsp;</a></span>crinitTaskDBExportTaskNamesToArray()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBExportTaskNamesToArray </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>tasks</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>numTasks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Export the list of task names currently in the task database.</p>
<p>The function allocates an array of strings as <em>tasks</em> and returns the number of array elements in <em>numTasks</em>. Each entry in the <em>tasks</em> array will be allocated separately and needs to be freed by the caller.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The TaskDB context from which to get the list of task names. </td></tr>
    <tr><td class="paramname">tasks</td><td>The return pointer for the array of task names. </td></tr>
    <tr><td class="paramname">numTasks</td><td>The return pointer for the number of array entries.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on error </dd></dl>

</div>
</div>
<a id="ad4e226b3c756bf1fdb2a45076413927f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4e226b3c756bf1fdb2a45076413927f">&#9670;&nbsp;</a></span>crinitTaskDBFulfillDep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBFulfillDep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcrinitTaskDep__t.html">crinitTaskDep_t</a> *&#160;</td>
          <td class="paramname"><em>dep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> *&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fulfill a dependency for all tasks inside a task database.</p>
<p>Will search <em>ctx</em> for tasks containing a dependency equal to <em>dep</em> (i.e. specifying the same name and event, according to strcmp()) and, if found, remove the dependency from <a class="el" href="structcrinitTask__t.html#ade4034f914b448f0cfb4e9249669ab95" title="Dynamic array of dependencies, corresponds to DEPENDS in the config file.">crinitTask_t::deps</a>. Will signal <a class="el" href="structcrinitTaskDB__t.html#aa4be37c52837a15547b6ae6d5782330f" title="Condition variable to be signalled if taskSet or spawnInhibit is changed.">crinitTaskDB_t::changed</a> on successful completion. The function uses <a class="el" href="structcrinitTaskDB__t.html#ac8f90459aa023df1a3f204af47ad8095">crinitTaskDB_t::lock</a> for synchronization and is thread-safe.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> context in which to fulfill the dependency. </td></tr>
    <tr><td class="paramname">dep</td><td>The dependency to be fulfilled. </td></tr>
    <tr><td class="paramname">target</td><td>The targeted task or NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>

</div>
</div>
<a id="a785eeee1d24013e61aadd00ced97cbac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a785eeee1d24013e61aadd00ced97cbac">&#9670;&nbsp;</a></span>crinitTaskDBGetTaskPID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBGetTaskPID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pid_t *&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>taskName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the PID of a task in a task database</p>
<p>Will search <em>ctx</em> for an <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> with <a class="el" href="structcrinitTask__t.html#a29602304fb5bb5d58159f9d7747a604e" title="Name of the task, corresponds to NAME in the config file.">crinitTask_t::name</a> lexicographically equal to <em>taskName</em> and write its PID to <em>pid</em>. If such a task does not exit in <em>ctx</em>, an error is returned. If the task does not currently have a running process, <em>pid</em> will be -1 but the function will indicate success. The function uses <a class="el" href="structcrinitTaskDB__t.html#ac8f90459aa023df1a3f204af47ad8095">crinitTaskDB_t::lock</a> for synchronization and is thread-safe.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> context in which the task is held. </td></tr>
    <tr><td class="paramname">pid</td><td>Pointer to store the returned PID. </td></tr>
    <tr><td class="paramname">taskName</td><td>The task's name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

</div>
</div>
<a id="a23e15de21b6b9c5a274eb13285d00f00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23e15de21b6b9c5a274eb13285d00f00">&#9670;&nbsp;</a></span>crinitTaskDBGetTaskState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBGetTaskState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crinit-sdefs_8h.html#a96326334c512388a4528407927f1d770">crinitTaskState_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>taskName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the crinitTaskState_t of a task in a task database</p>
<p>Will search <em>ctx</em> for an <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> with <a class="el" href="structcrinitTask__t.html#a29602304fb5bb5d58159f9d7747a604e" title="Name of the task, corresponds to NAME in the config file.">crinitTask_t::name</a> lexicographically equal to <em>taskName</em> and write its <a class="el" href="structcrinitTask__t.html#abfac7a104064c66f0ae14d1e3e2f4c36" title="Task state.">crinitTask_t::state</a> to <em>s</em>. If such a task does not exist in <em>ctx</em>, an error is returned. The function uses <a class="el" href="structcrinitTaskDB__t.html#ac8f90459aa023df1a3f204af47ad8095">crinitTaskDB_t::lock</a> for synchronization and is thread-safe.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> context in which the task is held. </td></tr>
    <tr><td class="paramname">s</td><td>Pointer to store the returned crinitTaskState_t. </td></tr>
    <tr><td class="paramname">taskName</td><td>The task's name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

</div>
</div>
<a id="a97d880e0b399c6fd9ef7ba90856dde96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97d880e0b399c6fd9ef7ba90856dde96">&#9670;&nbsp;</a></span>crinitTaskDBGetTaskStateAndPID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBGetTaskStateAndPID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crinit-sdefs_8h.html#a96326334c512388a4528407927f1d770">crinitTaskState_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pid_t *&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>taskName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the crinitTaskState_t and the PID of a task in a task database</p>
<p>Will search <em>ctx</em> for an <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> with <a class="el" href="structcrinitTask__t.html#a29602304fb5bb5d58159f9d7747a604e" title="Name of the task, corresponds to NAME in the config file.">crinitTask_t::name</a> lexicographically equal to <em>taskName</em> and write its <a class="el" href="structcrinitTask__t.html#abfac7a104064c66f0ae14d1e3e2f4c36" title="Task state.">crinitTask_t::state</a> to <em>s</em> and its PID to <em>pid</em>. If such a task does not exist in <em>ctx</em>, an error is returned. If the task does not currently have a running process, <em>pid</em> will be -1 but the function will indicate success. The function uses <a class="el" href="structcrinitTaskDB__t.html#ac8f90459aa023df1a3f204af47ad8095">crinitTaskDB_t::lock</a> for synchronization and is thread-safe.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> context in which the task is held. </td></tr>
    <tr><td class="paramname">s</td><td>Pointer to store the returned crinitTaskState_t. </td></tr>
    <tr><td class="paramname">pid</td><td>Pointer to store the returned PID. </td></tr>
    <tr><td class="paramname">taskName</td><td>The task's name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

</div>
</div>
<a id="a201bfdc33630f7b8baf3f90d8ca6d258"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a201bfdc33630f7b8baf3f90d8ca6d258">&#9670;&nbsp;</a></span>crinitTaskDBInitWithSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBInitWithSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(<a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *ctx, const <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> *)&#160;</td>
          <td class="paramname"><em>spawnFunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>initialSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the internals of an <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> with a specified initial size for <a class="el" href="structcrinitTaskDB__t.html#af548ac1ac231221121afa8cde3c14780" title="Dynamic array of tasks, corresponds to task configs specified in the series config.">crinitTaskDB_t::taskSet</a>.</p>
<p>If the initialized TaskDB is no longer needed the internally held dynamic memory should be freed using <a class="el" href="taskdb_8h.html#a0513aea87118637628ac26c83cd07e00">crinitTaskDBDestroy()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> whose internal members should be initialized. </td></tr>
    <tr><td class="paramname">spawnFunc</td><td>Pointer to the task spawn function to be used by <a class="el" href="taskdb_8h.html#a9414e5c37b05ee3e74261f98021736c4">crinitTaskDBSpawnReady()</a> </td></tr>
    <tr><td class="paramname">initialSize</td><td>Initial size of <a class="el" href="structcrinitTaskDB__t.html#af548ac1ac231221121afa8cde3c14780" title="Dynamic array of tasks, corresponds to task configs specified in the series config.">crinitTaskDB_t::taskSet</a> for <em>ctx</em>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>

</div>
</div>
<a id="a01bf0221c85ee5a9cbda759e3ffc0612"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01bf0221c85ee5a9cbda759e3ffc0612">&#9670;&nbsp;</a></span>crinitTaskDBInsert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBInsert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>overwrite</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Insert a task into a task database.</p>
<p>Will store a copy of <em>t</em> in the <a class="el" href="structcrinitTaskDB__t.html#af548ac1ac231221121afa8cde3c14780" title="Dynamic array of tasks, corresponds to task configs specified in the series config.">crinitTaskDB_t::taskSet</a> of <em>ctx</em>. <a class="el" href="structcrinitTaskDB__t.html#af34b8c979ae629b5af1fe5f512f031b0" title="Number of elements in the task array.">crinitTaskDB_t::taskSetItems</a> will be incremented and if <a class="el" href="structcrinitTaskDB__t.html#a63623c9a64a87ee917d30401df364968" title="Current maximum size of the task array.">crinitTaskDB_t::taskSetSize</a> is not sufficient, the set will be grown. If <em>overwrite</em> is true, a task with the same name in the set will be overwritten. If it is false, an existing task with the same name will cause an error. If the task has been successfully inserted, the function will signal <a class="el" href="structcrinitTaskDB__t.html#aa4be37c52837a15547b6ae6d5782330f" title="Condition variable to be signalled if taskSet or spawnInhibit is changed.">crinitTaskDB_t::changed</a>. The function uses <a class="el" href="structcrinitTaskDB__t.html#ac8f90459aa023df1a3f204af47ad8095">crinitTaskDB_t::lock</a> for synchronization and is thread-safe.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> context, into which task should be inserted. </td></tr>
    <tr><td class="paramname">t</td><td>The task to be inserted. </td></tr>
    <tr><td class="paramname">overwrite</td><td>Overwrite a colliding task with the same name (true) or return an error (false).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>

</div>
</div>
<a id="a7c001c5700abd471f8d7b2144018425d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c001c5700abd471f8d7b2144018425d">&#9670;&nbsp;</a></span>crinitTaskDBProvideFeature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBProvideFeature </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> *&#160;</td>
          <td class="paramname"><em>provider</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crinit-sdefs_8h.html#a96326334c512388a4528407927f1d770">crinitTaskState_t</a>&#160;</td>
          <td class="paramname"><em>newState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fulfill feature dependencies implemented by a provider task.</p>
<p>Will search <em>ctx</em> for tasks containing feature dependencies PROVIDE-ed by <em>provider</em> given its new state <em>newState</em> and, if found, remove the dependency from crinitTask_t::dep by using <a class="el" href="taskdb_8h.html#ad4e226b3c756bf1fdb2a45076413927f">crinitTaskDBFulfillDep()</a>. Synchronization and signalling remains the same as with a direct call to <a class="el" href="taskdb_8h.html#ad4e226b3c756bf1fdb2a45076413927f">crinitTaskDBFulfillDep()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> context in which to fulfill the feature dependency. </td></tr>
    <tr><td class="paramname">provider</td><td>The <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> providing the feature(s). </td></tr>
    <tr><td class="paramname">newState</td><td>The crinitTaskState_t which has been newly reached by <em>provider</em>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>

</div>
</div>
<a id="ae5f820ace0d5b55d533d7f846fc1dc15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5f820ace0d5b55d533d7f846fc1dc15">&#9670;&nbsp;</a></span>crinitTaskDBProvideFeatureByTaskName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBProvideFeatureByTaskName </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>taskName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crinit-sdefs_8h.html#a96326334c512388a4528407927f1d770">crinitTaskState_t</a>&#160;</td>
          <td class="paramname"><em>newState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fulfill feature dependencies implemented by a provider task (searched for by name).</p>
<p>Will search <em>ctx</em> for the provider task referenced by <em>taskName</em> and then call <a class="el" href="taskdb_8h.html#a7c001c5700abd471f8d7b2144018425d">crinitTaskDBProvideFeature()</a> on it (see there for details).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> context in which to fulfill the feature dependency. </td></tr>
    <tr><td class="paramname">taskName</td><td>The name of the task providing the feature(s). </td></tr>
    <tr><td class="paramname">newState</td><td>The crinitTaskState_t which has been newly reached by the provider task.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>

</div>
</div>
<a id="aa92d56059fed60ab94db38fed8ddf509"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa92d56059fed60ab94db38fed8ddf509">&#9670;&nbsp;</a></span>crinitTaskDBRemoveDepFromTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBRemoveDepFromTask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcrinitTaskDep__t.html">crinitTaskDep_t</a> *&#160;</td>
          <td class="paramname"><em>dep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>taskName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove a dependency from a specific task inside a task database.</p>
<p>Will search <em>ctx</em> for a task with name <em>taskName</em> and remove a dependency equal to <em>dep</em> from its <a class="el" href="structcrinitTask__t.html#ade4034f914b448f0cfb4e9249669ab95" title="Dynamic array of dependencies, corresponds to DEPENDS in the config file.">crinitTask_t::deps</a> and adjust <a class="el" href="structcrinitTask__t.html#a577a31bf5e540e93c859e4d3b53ccf67" title="Number of dependencies in deps array.">crinitTask_t::depsSize</a>, if such a dependency is present. The equality condition between two <a class="el" href="structcrinitTaskDep__t.html">crinitTaskDep_t</a> instances is the same as in <a class="el" href="taskdb_8h.html#ad4e226b3c756bf1fdb2a45076413927f">crinitTaskDBFulfillDep()</a>, i.e. their contents are lexicographically equal.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The crinitTaskDb context to work on. </td></tr>
    <tr><td class="paramname">dep</td><td>The dependency to be removed. </td></tr>
    <tr><td class="paramname">taskName</td><td>The name of the relevant task.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherweise </dd></dl>

</div>
</div>
<a id="a8e24830d7fdb34c95c8662e0452f697a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e24830d7fdb34c95c8662e0452f697a">&#9670;&nbsp;</a></span>crinitTaskDBSetSpawnInhibit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBSetSpawnInhibit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>inh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Inhibit or un-inhibit spawning of processes by setting <a class="el" href="structcrinitTaskDB__t.html#a48a1cd6ffad4abec7f3f98f7d9398f74" title="Specifies if process spawning is currently inhibited, respected by crinitTaskDBSpawnReady().">crinitTaskDB_t::spawnInhibit</a>.</p>
<p>The function uses <a class="el" href="structcrinitTaskDB__t.html#ac8f90459aa023df1a3f204af47ad8095">crinitTaskDB_t::lock</a> for synchronization and is thread-safe. It will also signal <a class="el" href="structcrinitTaskDB__t.html#aa4be37c52837a15547b6ae6d5782330f" title="Condition variable to be signalled if taskSet or spawnInhibit is changed.">crinitTaskDB_t::changed</a> if <a class="el" href="structcrinitTaskDB__t.html#a48a1cd6ffad4abec7f3f98f7d9398f74" title="Specifies if process spawning is currently inhibited, respected by crinitTaskDBSpawnReady().">crinitTaskDB_t::spawnInhibit</a> was changed to false.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The TaskDB context in which to set the variable. </td></tr>
    <tr><td class="paramname">inh</td><td>The value which <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a>:spawnInhibit shall be set to.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>

</div>
</div>
<a id="a3eef35669a9e906da28cf30e3e8e2317"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eef35669a9e906da28cf30e3e8e2317">&#9670;&nbsp;</a></span>crinitTaskDBSetTaskPID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBSetTaskPID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>taskName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the PID a task in a task database</p>
<p>Will search <em>ctx</em> for an <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> with <a class="el" href="structcrinitTask__t.html#a29602304fb5bb5d58159f9d7747a604e" title="Name of the task, corresponds to NAME in the config file.">crinitTask_t::name</a> lexicographically equal to <em>taskName</em> and set its <a class="el" href="structcrinitTask__t.html#ab5b8e3de21fa7cd74f18da0b3697e12a" title="PID of currently running process subordinate to the task, if any.">crinitTask_t::pid</a> to <em>pid</em>. If such a task does not exit in <em>ctx</em>, an error is returned. The function uses <a class="el" href="structcrinitTaskDB__t.html#ac8f90459aa023df1a3f204af47ad8095">crinitTaskDB_t::lock</a> for synchronization and is thread-safe.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> context in which the task is held. </td></tr>
    <tr><td class="paramname">pid</td><td>The task's new PID. </td></tr>
    <tr><td class="paramname">taskName</td><td>The task's name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

</div>
</div>
<a id="a86c7df5aac6ce38969ed52874a887f01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86c7df5aac6ce38969ed52874a887f01">&#9670;&nbsp;</a></span>crinitTaskDBSetTaskState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBSetTaskState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crinit-sdefs_8h.html#a96326334c512388a4528407927f1d770">crinitTaskState_t</a>&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>taskName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the crinitTaskState_t of a task in a task database</p>
<p>Will search <em>ctx</em> for an <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> with <a class="el" href="structcrinitTask__t.html#a29602304fb5bb5d58159f9d7747a604e" title="Name of the task, corresponds to NAME in the config file.">crinitTask_t::name</a> lexicographically equal to <em>taskName</em> and set its <a class="el" href="structcrinitTask__t.html#abfac7a104064c66f0ae14d1e3e2f4c36" title="Task state.">crinitTask_t::state</a> to <em>s</em>. If such a task does not exist in <em>ctx</em>, an error is returned. If <em>s</em> equals <a class="el" href="crinit-sdefs_8h.html#a0d9c49d0bab264f769bf49414a6cecec" title="Bitmask indicating a task has finished with an error code.">CRINIT_TASK_STATE_FAILED</a>, <a class="el" href="structcrinitTask__t.html#a1fc37e71d1faac1ed5861893610b2b68">crinitTask_t::failCount</a> will be incremented by 1. If <em>s</em> equals <a class="el" href="crinit-sdefs_8h.html#ae2c25b39f02dab5aba41cbbafcff876a" title="Bitmask indicating a task has finished without error.">CRINIT_TASK_STATE_DONE</a>, <a class="el" href="structcrinitTask__t.html#a1fc37e71d1faac1ed5861893610b2b68">crinitTask_t::failCount</a> will be reset to 0. The function uses <a class="el" href="structcrinitTaskDB__t.html#ac8f90459aa023df1a3f204af47ad8095">crinitTaskDB_t::lock</a> for synchronization and is thread-safe.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The <a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> context in which the task is held. </td></tr>
    <tr><td class="paramname">s</td><td>The task's new state. </td></tr>
    <tr><td class="paramname">taskName</td><td>The task's name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

</div>
</div>
<a id="a9414e5c37b05ee3e74261f98021736c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9414e5c37b05ee3e74261f98021736c4">&#9670;&nbsp;</a></span>crinitTaskDBSpawnReady()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crinitTaskDBSpawnReady </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrinitTaskDB__t.html">crinitTaskDB_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Run <a class="el" href="structcrinitTaskDB__t.html#a35541a79ea49728b9388060b73c009d6">crinitTaskDB_t::spawnFunc</a> for each startable task in a task database.</p>
<p>A task is startable if and only if it has no remaining <a class="el" href="structcrinitTask__t.html#ade4034f914b448f0cfb4e9249669ab95" title="Dynamic array of dependencies, corresponds to DEPENDS in the config file.">crinitTask_t::deps</a> and it has either not been started before according to <a class="el" href="structcrinitTask__t.html#abfac7a104064c66f0ae14d1e3e2f4c36" title="Task state.">crinitTask_t::state</a> or it should be respawned. A task should be respawned if and only if <a class="el" href="structcrinitTask__t.html#aa85b90bb84717368e4c4fd54ab4a797d" title="Task options.">crinitTask_t::opts</a> contains the flag <a class="el" href="task_8h.html#ae2b760fc1bb07e3373bafb8e23cb97e6" title="RESPAWN task option bitmask.">CRINIT_TASK_OPT_RESPAWN</a> and either <a class="el" href="structcrinitTask__t.html#a27b870f3a781be025b410d567372d1c2">crinitTask_t::maxRetries</a> is -1 or <a class="el" href="structcrinitTask__t.html#a1fc37e71d1faac1ed5861893610b2b68">crinitTask_t::failCount</a> is less than <a class="el" href="structcrinitTask__t.html#a27b870f3a781be025b410d567372d1c2">crinitTask_t::maxRetries</a>. The function uses <a class="el" href="structcrinitTaskDB__t.html#ac8f90459aa023df1a3f204af47ad8095">crinitTaskDB_t::lock</a> for synchronization and is thread-safe.</p>
<p>If crinitTaskDB::spawnInhibit is true, no tasks are considered startable and this function will return successfully without starting anything.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The TaskDB context from which tasks will be started.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>

</div>
</div>
<a id="ab9e2319b27f35044a7b2c10316f17dea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9e2319b27f35044a7b2c10316f17dea">&#9670;&nbsp;</a></span>crinitTaskIsReady()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool crinitTaskIsReady </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> *&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if an <a class="el" href="structcrinitTask__t.html">crinitTask_t</a> is considered ready to be started (startable).</p>
<p>See <a class="el" href="taskdb_8c.html#a9414e5c37b05ee3e74261f98021736c4">crinitTaskDBSpawnReady()</a> for further explanation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>The task to be checked for readiness.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if <em>t</em> is ready, false otherwise </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="taskdb_8c.html">taskdb.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
