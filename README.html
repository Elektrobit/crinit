<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="_static/favicon_16x16.png" sizes="16x16" rel="icon" type="image/png">
    <link href="_static/favicon_32x32.png" sizes="32x32" rel="icon" type="image/png">
    <title>Crinit – Configurable Rootfs Init &#8212; crinit  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Documentation" href="API-Doc.html" />
    <link rel="prev" title="Crinit – Configurable Rootfs Init" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="crinit-configurable-rootfs-init">
<h1>Crinit – Configurable Rootfs Init<a class="headerlink" href="#crinit-configurable-rootfs-init" title="Link to this heading">¶</a></h1>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">¶</a></h2>
<img src="_static/crinit_logo_blu.svg" width=20% height=20% align="right">
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<ul class="simple">
<li><p><a class="reference internal" href="#in-a-nutshell">In a Nutshell</a></p></li>
<li><p><a class="reference internal" href="#concept">Concept</a></p></li>
<li><p><a class="reference internal" href="#features">Features</a></p></li>
<li><p><a class="reference internal" href="#license">License</a></p></li>
<li><p><a class="reference internal" href="#powered-by-eb">Powered by EB</a></p></li>
<li><p><a class="reference internal" href="#maintainers">Maintainers</a></p></li>
<li><p><a class="reference internal" href="#credits">Credits</a></p></li>
<li><p><a class="reference internal" href="#artwork">Artwork</a></p></li>
<li><p><a class="reference internal" href="#command-line-options">Command-line options</a></p></li>
<li><p><a class="reference internal" href="#environment-variables">Environment Variables</a></p></li>
<li><p><a class="reference internal" href="#configuration">Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#example-global-configuration">Example Global Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#explanation">Explanation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#example-task-configuration">Example Task Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#id1">Explanation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#setting-environment-variables">Setting Environment Variables</a></p></li>
<li><p><a class="reference internal" href="#defining-elos-filters">Defining Elos Filters</a></p>
<ul>
<li><p><a class="reference internal" href="#ruleset">Ruleset</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#include-files">Include files</a></p></li>
<li><p><a class="reference internal" href="#io-redirections">IO Redirections</a></p>
<ul>
<li><p><a class="reference internal" href="#named-pipes">Named pipes</a></p></li>
<li><p><a class="reference internal" href="#a-note-on-buffering">A note on buffering</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dependency-groups-meta-tasks">Dependency groups (meta-tasks)</a></p></li>
<li><p><a class="reference internal" href="#configuration-signatures">Configuration Signatures</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#crinit-ctl-usage-info">crinit-ctl Usage Info</a></p></li>
<li><p><a class="reference internal" href="#smart-bash-completion-for-crinit-ctl">Smart bash completion for crinit-ctl</a></p></li>
<li><p><a class="reference internal" href="#crinit-launch">crinit-launch</a></p></li>
<li><p><a class="reference internal" href="#build-instructions">Build Instructions</a></p></li>
<li><p><a class="reference internal" href="#build-requirements">Build Requirements</a></p></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->
</section>
<section id="in-a-nutshell">
<h2>In a Nutshell<a class="headerlink" href="#in-a-nutshell" title="Link to this heading">¶</a></h2>
<p>Crinit is an init daemon executed as PID 1 by the Linux Kernel. It reads a global configuration (“series”-file) either
specified on the command line or from <code class="docutils literal notranslate"><span class="pre">/etc/crinit/default.series</span></code>. The series file in turn may reference further
configuration files or a whole directory from which all configs shall be loaded. Each one defines a task potentially
containing a set of commands and dependencies on other tasks.</p>
<p>The specified tasks are then started with as much parallelism as dependencies allow, i.e. tasks without any dependencies
are spawned as soon as possible after Crinit has been started. Once a task is spawned, finished, or has failed, its
dependent tasks are updated and spawned as necessary.</p>
</section>
<section id="concept">
<h2>Concept<a class="headerlink" href="#concept" title="Link to this heading">¶</a></h2>
<p>The below diagram shows the overall concept of Crinit.</p>
<p><img alt="Rootfs Init Daemon Components" src="_images/rootfs_init_comp.svg" /></p>
<p>Not indicated in the diagram are planned cryptographic features of the Config Parser intended to provide optional
verification/integrity checking of the global and task configurations.</p>
</section>
<section id="features">
<h2>Features<a class="headerlink" href="#features" title="Link to this heading">¶</a></h2>
<p>Crinit currently has the following features implemented:</p>
<ul class="simple">
<li><p>starting of tasks with parallelism and dependency-resolution</p>
<ul>
<li><p>tasks may have one or multiple commands, or none to form a dependency group</p></li>
<li><p>dependencies can be either on specific task state changes or on “features” another (unknown) task will provide</p></li>
<li><p>timestamping of creation, start, and end times of a task</p></li>
</ul>
</li>
<li><p>a C client API and a command-line interface using it (<code class="docutils literal notranslate"><span class="pre">crinit-ctl</span></code>) capable of</p>
<ul>
<li><p>adding new tasks</p></li>
<li><p>managing (stop, kill, restart, …) already loaded tasks</p></li>
<li><p>querying task status and timestamps</p></li>
<li><p>handling reboot and poweroff</p></li>
<li><p>a basic source-compatible implementation of <code class="docutils literal notranslate"><span class="pre">sd_notify()</span></code></p></li>
</ul>
</li>
<li><p>task IO redirection (like shell pipes)</p>
<ul>
<li><p>to files, for example for basic logging purposes</p></li>
<li><p>to named pipes, to pipe output between tasks</p></li>
</ul>
</li>
<li><p>task environment variable management</p>
<ul>
<li><p>a global environment can be set</p></li>
<li><p>task-specific local settings can override and/or extend the global environment</p></li>
</ul>
</li>
<li><p>include files to maintain task configuration presets</p></li>
<li><p>optional integration with <a class="reference external" href="https://github.com/Elektrobit/elos">elos</a></p>
<ul>
<li><p>support for events sent by elos as task dependencies</p></li>
</ul>
</li>
<li><p>ability to report task state changes back to elos</p>
<ul>
<li><p>emits appropriate events when a task is created, starts, exits, or fails</p></li>
</ul>
</li>
<li><p>optional signature checking of Crinit’s configuration files</p></li>
<li><p>setting of UID and GID a task should be run as</p></li>
</ul>
<p>In the future we also plan to support:</p>
<ul class="simple">
<li><p>fine-grained restriction of processes started/managed by Crinit</p>
<ul>
<li><p>capabilities, cgroups,…</p></li>
</ul>
</li>
</ul>
<p>There are example configurations below which show how to use the currently implemented features.
For detailed explanations of Crinit’s inner workings please refer to the Doxygen documentation generated during build.
The client API is documented in the Doxygen documentation of <code class="docutils literal notranslate"><span class="pre">crinit-client.h</span></code>. The API is implemented as a shared
library (<code class="docutils literal notranslate"><span class="pre">libcrinit-client.so</span></code>).</p>
<p>This repository also includes an example application to generate a <code class="docutils literal notranslate"><span class="pre">/etc/machine-id</span></code> file, which is used to uniquely
identify the system (for example by <code class="docutils literal notranslate"><span class="pre">elosd</span></code>). The <code class="docutils literal notranslate"><span class="pre">machine-id-gen</span></code> tool is supposed to be called on boot, for example
from <code class="docutils literal notranslate"><span class="pre">earlysetup.crinit</span></code> as shown in the example configuration files contained in this repository. Its implementation
either uses the value for <code class="docutils literal notranslate"><span class="pre">systemd.machine_id</span></code> given on the Kernel command line or – on an NXP S32G-based board – the
unique ID burned to on-chip OTP memory. If the Kernel command line value is set, it always takes precedence and any
physical memory OTP reads are omitted. This means that while the application has special functionality for S32G SoCs,
it can work on any target as long as the Kernel command line contains the necessary value.</p>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Link to this heading">¶</a></h2>
<p>MIT License</p>
<p>Copyright (c) [2023] [emlix GmbH, Elektrobit Automotive GmbH]</p>
<p>The full text of the license can be found in the <a class="reference download internal" download="" href="_downloads/9879d6db96fd29134fc802214163b95a/LICENSE"><span class="xref download myst">LICENSE</span></a> file in the repository root directory.</p>
</section>
<section id="powered-by-eb">
<h2>Powered by EB<a class="headerlink" href="#powered-by-eb" title="Link to this heading">¶</a></h2>
<img src="_static/eb-logo.png" width=70 height=70 hspace=10 align="left">
Crinit is powered by Elektrobit Automotive GmbH.
<p>Elektrobit is an automotive software company and developer of embedded software products for ECU, AUTOSAR, automated
driving, connected vehicles and UX. Crinit is an integrated part of EB corbos Linux.</p>
<p>EB corbos Linux – built on Ubuntu - is an open-source operating system for high-performance computing, leveraging the
rich functionality of Linux while meeting security and industry regulations.</p>
</section>
<section id="maintainers">
<h2>Maintainers<a class="headerlink" href="#maintainers" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Andreas Zdziarstek andreas.zdziarstek&#64;emlix.com <a class="reference external" href="https://github.com/gmcn42">&#64;gmcn42</a></p></li>
<li><p>Thomas Brinker thomas.brinker&#64;emlix.com <a class="reference external" href="https://github.com/ThomasBrinker">&#64;ThomasBrinker</a></p></li>
</ul>
</section>
<section id="credits">
<h2>Credits<a class="headerlink" href="#credits" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Andreas Schickedanz</p></li>
<li><p>Andreas Zdziarstek</p></li>
<li><p>Anja Lehwess-Litzmann</p></li>
<li><p>Annika Schmitt</p></li>
<li><p>Anton Hillebrand</p></li>
<li><p>Daniel Glöckner</p></li>
<li><p>Rainer Müller</p></li>
<li><p>Stefan Kral</p></li>
<li><p>Thomas Brinker</p></li>
<li><p>Wolfgang Gehrhardt</p></li>
</ul>
</section>
<section id="artwork">
<h2>Artwork<a class="headerlink" href="#artwork" title="Link to this heading">¶</a></h2>
<p>The crinit logo is the Swallow (Hirundinidae). A quick and small bird able to fly long distances. Originator is Anja
Lehwess-Litzmann (emlix GmbH). Year 2023. It is licensed under Creative Commons No Derivatives (CC-nd). It shall be used
in black on white or HKS43 color.</p>
</section>
<section id="command-line-options">
<h2>Command-line options<a class="headerlink" href="#command-line-options" title="Link to this heading">¶</a></h2>
<p>Crinit is mainly configured via global and task-specific configuration files. There are, however, some specific options
related to its behavior as a secondary init process (e.g. if crinit is started by another init process, or even itself).
These options can only be changed through command-line parameters.</p>
<p>Specifically, those are</p>
<ul class="simple">
<li><p><strong>–sys-mounts/–no-sys-mounts</strong> - Depending on the setting, Crinit will or will not mount some hardcoded system
directories. Some of these are needed by Crinit itself to function. So, if deactivated, they need to be already
mounted when Crinit starts. If activated, Crinit will mount</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">/dev</span></code> - devtmpfs pseudo file system</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/dev/pts</span></code> - devpts pseudo file system</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/proc</span></code> - procfs filesystem, needed by Crinit to parse the Kernel cmdline</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/run</span></code> - tmpfs, needed by Crinit to create its socket (default location)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/sys</span></code> - sysfs pseudo file system
Default: Activated if Crinit is PID 1, otherwise deactivated.</p></li>
</ul>
</li>
<li><p><strong>–child-subreaper/–no-child-subreaper</strong> - Depending on the setting, Crinit will or will not provide a process with
“child subreaper” process attribute (see <a class="reference external" href="https://man7.org/linux/man-pages/man2/PR_SET_CHILD_SUBREAPER.2const.html">PR_SET_CHILD_SUBREAPER manpage</a>).
This is a relevant setting only if Crinit is not PID 1, i.e. started as a secondary init process. In that case,
Crinit can use this setting to provide the “zombie reaper” function for its descendent processes. For example, this
can be helpful in some containerization scenarios. If Crinit is PID 1, however, it will always provide a “zombie
reaper” regardless of this setting.
By default, Crinit will respect the attribute as it is set when Crinit is started and behave accordingly, i.e. if
Crinit either is PID 1 or it has the CHILD_SUBREAPER process attribute, it will reap zombies of its descendants.</p></li>
</ul>
</section>
<section id="environment-variables">
<h2>Environment Variables<a class="headerlink" href="#environment-variables" title="Link to this heading">¶</a></h2>
<p>Crinit also respects the environment variable</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CRINIT_SOCK</span></code> - The path to the socket file Crinit will create for communication through <code class="docutils literal notranslate"><span class="pre">libcrinit-client</span></code>.
Default: <code class="docutils literal notranslate"><span class="pre">/run/crinit/crinit.sock</span></code></p></li>
</ul>
<p>Note that <code class="docutils literal notranslate"><span class="pre">crinit-ctl</span></code> uses the same environment variable to decide to which socket it will connect to. This makes it
possible to have multiple instances of crinit running alongside each other, each controlled through a different socket.</p>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h2>
<p>As described above, Crinit needs a global series-file containing global configuration options as well as a list of task
configurations. Examples for a local demonstration inside the build environment (see <a class="reference internal" href="#build-instructions">Build
Instructions</a> below) are available in <code class="docutils literal notranslate"><span class="pre">config/test/</span></code> and examples to use as a starting point for a
minimal system boot are available in <code class="docutils literal notranslate"><span class="pre">config/example/</span></code>.</p>
<p>The general format of crinit configuration files is INI-style <code class="docutils literal notranslate"><span class="pre">KEY</span> <span class="pre">=</span> <span class="pre">value</span></code> pairs. Some settings may be array-like,
meaning they can be specified multiple times to append values. Leaving out the <code class="docutils literal notranslate"><span class="pre">KEY</span> <span class="pre">=</span></code> part at the start of the line in
favor of at least one whitespace character is shorthand for appending to the last key, for example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">ARRAY_LIKE_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">value 1</span>
<span class="na">ARRAY_LIKE_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">value 2</span>
</pre></div>
</div>
<p>is equivalent to</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">ARRAY_LIKE_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">value 1</span>
<span class="w">                 </span><span class="na">value 2</span>
</pre></div>
</div>
<section id="example-global-configuration">
<h3>Example Global Configuration<a class="headerlink" href="#example-global-configuration" title="Link to this heading">¶</a></h3>
<p>An example to boot a minimal environment may look like this:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crinit global configuration file</span>

<span class="na">TASKS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">earlysetup.crinit check_qemu.crinit network-dhcp.crinit</span>
<span class="w">        </span><span class="na">sshd.crinit getty.crinit</span>

<span class="na">TASKDIR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/etc/crinit</span>
<span class="na">TASK_FILE_SUFFIX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">.crinit</span>
<span class="na">TASKDIR_FOLLOW_SYMLINKS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">YES</span>
<span class="na">INCLUDEDIR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/etc/crinit</span>
<span class="na">INCLUDE_SUFFIX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">.crincl</span>
<span class="na">DEBUG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">NO</span>

<span class="na">SHUTDOWN_GRACE_PERIOD_US</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">100000</span>

<span class="na">LAUNCHER_CMD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/usr/bin/crinit-launch</span>

<span class="na">USE_SYSLOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">NO</span>
<span class="na">USE_ELOS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">YES</span>

<span class="na">ELOS_SERVER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">192.168.3.43</span>
<span class="na">ELOS_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2342</span>
<span class="na">ELOS_EVENT_POLL_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">250000</span>

<span class="na">ENV_SET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">FOO &quot;foo&quot;</span>
<span class="na">ENV_SET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">FOO_BAZ &quot;${FOO} baz&quot;</span>
<span class="na">ENV_SET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">GREETING &quot;Good morning!&quot;</span>
</pre></div>
</div>
<section id="explanation">
<h4>Explanation<a class="headerlink" href="#explanation" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><strong>TASKS</strong> – The task configurations to load. This is an optional setting. If not set, <strong>TASKDIR</strong> will be scanned for
task configuration files. (<em>array-like</em>)</p></li>
<li><p><strong>TASKDIR</strong> – Where to find the task configurations, will be prepended to the filenames in <strong>TASKS</strong>.
Default: <code class="docutils literal notranslate"><span class="pre">/etc/crinit</span></code></p></li>
<li><p><strong>TASK_FILE_SUFFIX</strong> – Filename suffix of task configurations. Only relevant if <strong>TASKS</strong> is not set.
Default: <code class="docutils literal notranslate"><span class="pre">.crinit</span></code></p></li>
<li><p><strong>TASKDIR_FOLLOW_SYMLINKS</strong> – If symbolic links should be followed during scanning of <strong>TASKDIR</strong>. Only relevant if
<strong>TASKS</strong> is not set. Default: YES</p></li>
<li><p><strong>INCLUDEDIR</strong> – Where to find include files referenced from task configurations. Default: Same as <strong>TASKDIR</strong>.</p></li>
<li><p><strong>INCLUDE_SUFFIX</strong> – Filename suffix of include files referenced from task configurations. Default: <code class="docutils literal notranslate"><span class="pre">.crincl</span></code></p></li>
<li><p><strong>DEBUG</strong> – If crinit should be verbose in its output. Either <code class="docutils literal notranslate"><span class="pre">YES</span></code> or <code class="docutils literal notranslate"><span class="pre">NO</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">NO</span></code></p></li>
<li><p><strong>LAUNCHER_CMD</strong> – Specify location of the crinit-launch binary. Optional. If not given, crinit-launch is taken from
the default installation path. Needed to execute a <strong>COMMAND</strong> as a different user or group.</p></li>
<li><p><strong>SHUTDOWN_GRACE_PERIOD_US</strong> – The amount of microseconds to wait both between <code class="docutils literal notranslate"><span class="pre">STOP_COMMAND</span></code> and <code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code> as well
as between<code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code> and <code class="docutils literal notranslate"><span class="pre">SIGKILL</span></code> on shutdown/reboot.
Default: 100000</p></li>
<li><p><strong>USE_SYSLOG</strong> – If syslog should be used for output if it is available. If set to <code class="docutils literal notranslate"><span class="pre">YES</span></code>, Crinit will switch to
syslog for output as soon as a task file <code class="docutils literal notranslate"><span class="pre">PROVIDES</span></code> the <code class="docutils literal notranslate"><span class="pre">syslog</span></code> feature. Ideally this should be a task file loading
a syslog server such as syslogd or elosd. Default: <code class="docutils literal notranslate"><span class="pre">NO</span></code></p></li>
<li><p><strong>USE_ELOS</strong> – If Elos should be used as event based dependency provider if it is available. If set to <code class="docutils literal notranslate"><span class="pre">YES</span></code>, Crinit
will allow Elos event filters as task dependencies with the <code class="docutils literal notranslate"><span class="pre">&#64;elos</span></code> prefix as soon as a task file <code class="docutils literal notranslate"><span class="pre">PROVIDES</span></code> the
<code class="docutils literal notranslate"><span class="pre">elos</span></code> feature. Ideally this should be a task file loading the Elos daemon elosd. Default is <code class="docutils literal notranslate"><span class="pre">NO</span></code>.
Needs ELOS support included at build-time.</p></li>
<li><p><strong>ELOS_SERVER</strong> – Ip address of the elos server. Default: <code class="docutils literal notranslate"><span class="pre">127.0.0.1</span></code>
Needs ELOS support included at build-time.</p></li>
<li><p><strong>ELOS_PORT</strong> – Port of the elos server. Default: <code class="docutils literal notranslate"><span class="pre">54321</span></code>
Needs ELOS support included at build-time.</p></li>
<li><p><strong>ELOS_EVENT_POLL_INTERVAL</strong> – Interval in microseconds between polling requests for events from elos. This is a
tradeoff between idle CPU use and latency of tasks depending on an elos event (see section <strong>Defining Elos Filters</strong>
below). Default is 500000. Needs ELOS support included at build-time.</p></li>
<li><p><strong>ENV_SET</strong> – See section <strong>Setting Environment Variables</strong> below. (<em>array-like</em>)</p></li>
<li><p><strong>FILTER_DEFINE</strong> – See section <strong>Defining Elos Filters</strong> below. (<em>array-like</em>)</p></li>
</ul>
</section>
</section>
<section id="example-task-configuration">
<h3>Example Task Configuration<a class="headerlink" href="#example-task-configuration" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">network-dhcp.crinit</span></code> from above could for example look like this:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># DHCP config for a minimal system</span>

<span class="na">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">network-dhcp</span>

<span class="na">INCLUDE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">daemon_env_preset</span>

<span class="na">COMMAND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/bin/mkdir -p /var/lib/dhcpcd</span>
<span class="w">          </span><span class="na">/bin/mount -t tmpfs none /var/lib/dhcpcd</span>
<span class="w">          </span><span class="na">/bin/touch /var/lib/dhcpcd/resolv.conf</span>
<span class="w">          </span><span class="na">/bin/mount -o bind /var/lib/dhcpcd/resolv.conf /etc/resolv.conf</span>
<span class="w">          </span><span class="na">/sbin/ifconfig lo up</span>
<span class="w">          </span><span class="na">/sbin/ifconfig lo 127.0.0.1</span>
<span class="w">          </span><span class="na">/sbin/dhcpcd -j /var/log/dhcpcd.log eth0</span>

<span class="na">STOP_COMMAND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/sbin/ifconfig eth0 down</span>

<span class="na">USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">root</span>
<span class="na">GROUP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">root</span>

<span class="na">DEPENDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">check_qemu:fail earlysetup:wait @provided:writable_var</span>

<span class="na">PROVIDES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">ipv4_dhcp:wait resolvconf:wait</span>

<span class="na">RESPAWN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">NO</span>
<span class="na">RESPAWN_RETRIES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">-1</span>

<span class="na">ENV_SET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">FOO_BAR &quot;${FOO} bar&quot;</span>
<span class="w">          </span><span class="na">ESCAPED_VAR &quot;Global variable name</span><span class="o">:</span><span class="w"> </span><span class="s">\${FOO}&quot;</span>
<span class="w">          </span><span class="na">VAR_WITH_ESC_SEQUENCES &quot;hex\t\x68\x65\x78&quot;</span>
<span class="w">          </span><span class="na">GREETING &quot;Good evening!&quot;</span>

<span class="na">IO_REDIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">STDOUT &quot;/var/log/net-dhcp.log&quot; APPEND 0644</span>
<span class="na">IO_REDIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">STDERR STDOUT</span>
</pre></div>
</div>
<section id="id1">
<h4>Explanation<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><strong>NAME</strong> – The name given to this task configuration. Relevant if other tasks want to depend on this one. This is a
mandatory setting.</p></li>
<li><p><strong>INCLUDE</strong> – See section <strong>Include files</strong> below. (<em>array-like</em>)</p></li>
<li><p><strong>COMMAND</strong> – The commands to be executed in series. Executable paths must be absolute. Execution will stop if
one of them fails and the whole task will be considered failed. The whole task is considered finished (i.e.
the <code class="docutils literal notranslate"><span class="pre">network-dhcp:wait</span></code> dependency is fulfilled) if the last command has successfully returned. If no <strong>COMMAND</strong> is
given, the task is treated as a dependency group or “meta-task”, see below. (<em>array-like</em>)</p></li>
<li><p><strong>STOP_COMMAND</strong> – Optional. Given commands are executed on <code class="docutils literal notranslate"><span class="pre">crinit-ctl</span> <span class="pre">stop</span> <span class="pre">&lt;TASKNAME&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">crinit-ctl</span> <span class="pre">poweroff</span></code> or
<code class="docutils literal notranslate"><span class="pre">crinit-ctl</span> <span class="pre">reboot</span></code> instead of sending the regular <code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code>. Same rules as for <strong>COMMAND</strong> apply. Additionally the
variable “TASK_PID” can be used and will be expanded with the stored PID of the task.
Example: <code class="docutils literal notranslate"><span class="pre">STOP_COMMAND</span> <span class="pre">=</span> <span class="pre">/usr/bin/kill</span> <span class="pre">${TASK_PID}</span></code>.
Please note that TASK_PID will expand to “-1” if the task is no longer running or has forked itself without notifying
Crinit. <strong>ATTENTION:</strong> Currently <code class="docutils literal notranslate"><span class="pre">STOP_COMMAND</span></code> does not support <code class="docutils literal notranslate"><span class="pre">IO_REDIRECT</span></code>! Its output will not be redirected!</p></li>
<li><p><strong>USER</strong> – Name of the user used to run the commands specified in <strong>COMMAND</strong>. Either the username or the numeric
user ID can be used. If <strong>USER</strong> is not set, “root” is assumed.
<strong>NOTE</strong>: Changing user names, UIDs, group names or GIDs on the system while a task using them has already been
loaded may result in undefined behaviour.</p></li>
<li><p><strong>GROUP</strong> – Name of the group used to run the commands specified in <strong>COMMAND</strong>. Either the group name or the numeric
group ID can be used. If <strong>GROUP</strong> is not set, “root” is assumed. Supplementary groups can be added after the main group, space separated. GROUP can be an array, too. Similar to <strong>COMMAND</strong>.
<strong>Also see note on USER command.</strong> This applies here, too.</p></li>
<li><p><strong>DEPENDS</strong> – A list of dependencies which need to be fulfilled before this task is considered “ready-to-start”.
Semantics are <code class="docutils literal notranslate"><span class="pre">&lt;taskname&gt;:{fail,wait,spawn}</span></code>, where <code class="docutils literal notranslate"><span class="pre">spawn</span></code> is fulfilled when (the first command of) a task has been
started, <code class="docutils literal notranslate"><span class="pre">wait</span></code> if it has successfully completed, and <code class="docutils literal notranslate"><span class="pre">fail</span></code> if it has failed somewhere along the way. Here we can see
this task is only run if and after the <code class="docutils literal notranslate"><span class="pre">earlysetup</span></code> (setup of system directories, etc.) has fully completed and the
<code class="docutils literal notranslate"><span class="pre">check_qemu</span></code> task has determined we are <em>not</em> running inside the emulator and therefore exited with an error code.
This may be left out or explicitly set to empty using <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> which is interpreted as “no dependencies”.
There is also the special <code class="docutils literal notranslate"><span class="pre">&#64;provided:feature</span></code> syntax where we can define we want to depend on a specific feature
another task may implement (see <strong>PROVIDES</strong>). In this case <code class="docutils literal notranslate"><span class="pre">&#64;provided:writable_var</span></code> could mean that another task
may have mounted a tmpfs or a writable partition there which we need for the first <code class="docutils literal notranslate"><span class="pre">mkdir</span></code>. That task would need to
advertise the <code class="docutils literal notranslate"><span class="pre">writable_var</span></code> feature in its <code class="docutils literal notranslate"><span class="pre">PROVIDES</span></code> config value. (<em>array-like</em>)
Additionally there is an optional feature that allows tasks to be started based on system events issued by elos.
Tasks depending on an elos event can use the <code class="docutils literal notranslate"><span class="pre">&#64;elos:&lt;filter_name&gt;</span></code> syntax to specify a task dependency that is fullfilled
as soon as the specified elos filter triggers. The filters themself can be specified using the <strong>FILTER_DEFINE</strong> keyword.</p></li>
<li><p><strong>PROVIDES</strong> – As we have seen above, a task may depend on features and also provide them. In this case we advertise
that after completion of this task (<code class="docutils literal notranslate"><span class="pre">wait</span></code>), the features <code class="docutils literal notranslate"><span class="pre">ipv4_dhcp</span></code> and <code class="docutils literal notranslate"><span class="pre">resolvconf</span></code> are provided. Another task may
then depend e.g. on <code class="docutils literal notranslate"><span class="pre">&#64;provided:resolvconf</span></code>. While the feature names chosen here reflect the functional intention, they
can be chosen arbitrarily. (<em>array-like</em>)</p></li>
<li><p><strong>RESPAWN</strong> – If set to <code class="docutils literal notranslate"><span class="pre">YES</span></code>, the task will be restarted on failure or completion. Useful for daemons like <code class="docutils literal notranslate"><span class="pre">getty</span></code>.
Default: <code class="docutils literal notranslate"><span class="pre">NO</span></code></p></li>
<li><p><strong>RESPAWN_RETRIES</strong> – Number of times a respawned task may fail <em>in a row</em> before it is not started again. The
special value <code class="docutils literal notranslate"><span class="pre">-1</span></code> is interpreted as “unlimited”. Default: -1</p></li>
<li><p><strong>ENV_SET</strong> – See section <strong>Setting Environment Variables</strong> below. (<em>array-like</em>)</p></li>
<li><p><strong>FILTER_DEFINE</strong> – See section <strong>Defining Elos Filters</strong> below. (<em>array-like</em>)</p></li>
<li><p><strong>IO_REDIRECT</strong> – See section <strong>IO Redirections</strong> below. (<em>array-like</em>)</p></li>
</ul>
</section>
</section>
<section id="setting-environment-variables">
<h3>Setting Environment Variables<a class="headerlink" href="#setting-environment-variables" title="Link to this heading">¶</a></h3>
<p>Crinit supports setting environment variables in the global and task configurations as shown above. The variables in the
global config are valid for all tasks and may be locally overriden or referenced. The above examples together would
result in the following list of environment variables for the task <code class="docutils literal notranslate"><span class="pre">network-dhcp</span></code> (with explanatory comments).</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nv">FOO</span><span class="o">=</span>foo
<span class="nv">FOO_BAZ</span><span class="o">=</span>foo<span class="w"> </span>baz<span class="w">                            </span><span class="c1"># Expansion of variable set before in the same config.</span>
<span class="nv">FOO_BAR</span><span class="o">=</span>foo<span class="w"> </span>bar<span class="w">                            </span><span class="c1"># Expansion of global variable in task-local variable.</span>
<span class="nv">GREETING</span><span class="o">=</span>Good<span class="w"> </span>evening!<span class="w">                     </span><span class="c1"># Override of global variable.</span>
<span class="nv">ESCAPED_VAR</span><span class="o">=</span>Global<span class="w"> </span>variable<span class="w"> </span>name:<span class="w"> </span><span class="si">${</span><span class="nv">FOO</span><span class="si">}</span><span class="w">   </span><span class="c1"># Avoid variable expansion through escaping.</span>
<span class="nv">VAR_WITH_ESC_SEQUENCES</span><span class="o">=</span>hex<span class="w">  </span>hex<span class="w">            </span><span class="c1"># Support for escape sequences including hexadecimal bytes.</span>
</pre></div>
</div>
</section>
<section id="defining-elos-filters">
<h3>Defining Elos Filters<a class="headerlink" href="#defining-elos-filters" title="Link to this heading">¶</a></h3>
<p>Crinit supports an optional feature, which enables a task to depend on specific system events issued by the elos event
logger. This needs ELOS support included at build-time.</p>
<p>In order to depend on elos events, a task uses the <code class="docutils literal notranslate"><span class="pre">&#64;elos</span></code> dependency prefix in conjunction with a elos filter name. The
corresponding filter has to be defined within the task itself or within the global environment. The definition follows
the syntax of normal environment variables, but uses the <code class="docutils literal notranslate"><span class="pre">FILTER_DEFINE</span></code> prefix instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FILTER_DEFINE</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">filter_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">filter_rule</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">elos_ssh_event_task</span>
<span class="na">COMMAND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/bin/echo &quot;Event task has been run.&quot;</span>

<span class="na">FILTER_DEFINE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">SSHD_FILTER &quot;.event.source.appName &#39;sshd&#39; STRCMP&quot;</span>

<span class="na">DEPENDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@elos:SSHD_FILTER</span>
</pre></div>
</div>
<section id="ruleset">
<h4>Ruleset<a class="headerlink" href="#ruleset" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>A configuration file may have an unlimited number of <code class="docutils literal notranslate"><span class="pre">ENV_SET</span></code> statements, each specifying a single environment
variable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ENV_SET</span></code> statements must be of the form <code class="docutils literal notranslate"><span class="pre">ENV_SET</span> <span class="pre">=</span> <span class="pre">VARIABLE_NAME</span> <span class="pre">&quot;variable</span> <span class="pre">content&quot;</span></code>. The quotes around the variable
content are mandatory and will not appear in the environment variable itself.</p></li>
<li><p>Setting the same variable twice overrides the first instance.</p></li>
<li><p>Variables can be referenced/expanded using shell-like <code class="docutils literal notranslate"><span class="pre">${VARIABLE_NAME}</span></code> syntax.</p>
<ul>
<li><p>Expansion can be avoided by escaping with a <code class="docutils literal notranslate"><span class="pre">\</span></code>.</p></li>
</ul>
</li>
<li><p>Variables can reference all other variables set before it, globally and locally.</p></li>
<li><p>Variables are set/processed in the order they appear in the config file.</p></li>
<li><p>Common escape sequences are supported: <code class="docutils literal notranslate"><span class="pre">\a,</span> <span class="pre">\b,</span> <span class="pre">\n,</span> <span class="pre">\t,</span> <span class="pre">\$,</span> <span class="pre">\\,</span> <span class="pre">\x&lt;two</span> <span class="pre">digit</span> <span class="pre">hex</span> <span class="pre">number&gt;</span></code>.</p></li>
</ul>
</section>
</section>
<section id="include-files">
<h3>Include files<a class="headerlink" href="#include-files" title="Link to this heading">¶</a></h3>
<p>A crinit task configuration may reference multiple include files at any point in the task file. The effect is the same
as manually copying the contents of the include file at exactly that point in the task config, similar to C includes.
Additionally, it is possible to define an import list if not all settings in the include file should be applied.</p>
<p>An INCLUDE statement looks like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INCLUDE</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">include_name</span><span class="o">&gt;</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span><span class="n">of</span><span class="p">,</span><span class="n">imported</span><span class="p">,</span><span class="n">settings</span><span class="p">]</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;include_name&gt;</span></code> is the filename of the include without the ending and without the leading path. The imported
settings are defined as a comma-separated list of possible configuration options. If omitted, everything in the include
file is taken.</p>
<p>Currently only <code class="docutils literal notranslate"><span class="pre">IO_REDIRECT</span></code>, <code class="docutils literal notranslate"><span class="pre">DEPENDS</span></code>, and <code class="docutils literal notranslate"><span class="pre">ENV_SET</span></code> are supported in include files.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">INCLUDE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">server_settings ENV_SET,IO_REDIRECT</span>
</pre></div>
</div>
<p>Imports only the <code class="docutils literal notranslate"><span class="pre">ENV_SET</span></code> and <code class="docutils literal notranslate"><span class="pre">IO_REDIRECT</span></code> settings from (assuming default values for include dir and suffix)
<code class="docutils literal notranslate"><span class="pre">/etc/crinit/server_settings.crincl</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">server_settings.crincl</span></code> could look like</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">ENV_SET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">HTTP_PORT &quot;8080&quot;</span>
<span class="na">IO_REDIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">STDOUT /some/file.txt</span>
<span class="na">IO_REDIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">STDERR STDOUT</span>
<span class="na">DEPENDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@provided:network</span>
</pre></div>
</div>
<p>In the above case, the DEPENDS setting would be ignored.</p>
</section>
<section id="io-redirections">
<h3>IO Redirections<a class="headerlink" href="#io-redirections" title="Link to this heading">¶</a></h3>
<p>Crinit supports per-task IO redirection to/from file and between STDOUT/IN/ERR using <code class="docutils literal notranslate"><span class="pre">IO_REDIRECT</span></code> statements in the
task configurations. Please note that currently IO redirections do not work for STOP_COMMAND. The statements are of the
form</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">REDIRECT_FROM</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">REDIRECT_TO</span><span class="o">&gt;</span> <span class="p">[</span> <span class="n">APPEND</span> <span class="o">|</span> <span class="n">TRUNCATE</span> <span class="o">|</span> <span class="n">PIPE</span> <span class="p">]</span> <span class="p">[</span> <span class="n">OCTAL_MODE</span> <span class="p">]</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">REDIRECT_FROM</span></code> is one of <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">STDOUT,</span> <span class="pre">STDERR,</span> <span class="pre">STDIN</span> <span class="pre">}</span></code>, and <code class="docutils literal notranslate"><span class="pre">REDIRECT_TO</span></code> may either also be one of those streams
or an absolute path to a file. <code class="docutils literal notranslate"><span class="pre">APPEND</span></code> or <code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code> signify whether an existing file at that location should be
appended to or truncated. Default is <code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code>. The special value <code class="docutils literal notranslate"><span class="pre">PIPE</span></code> is discussed below (see <em>Named Pipes</em>).
<code class="docutils literal notranslate"><span class="pre">OCTAL_MODE</span></code> sets the permission bits if the file is newly created. Default is <code class="docutils literal notranslate"><span class="pre">0644</span></code>.</p>
<p>Accordingly the statements in the example configuration above will result in <code class="docutils literal notranslate"><span class="pre">stdout</span></code> being redirected to the file
<code class="docutils literal notranslate"><span class="pre">/var/log/net-dhcp.log</span></code> in append mode. If the file does not yet exist, it will be created with permission bits <code class="docutils literal notranslate"><span class="pre">0644</span></code>.
The second statement then redirects stderr to stdout, capturing both in the log.</p>
<p>Other examples could be</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">IO_REDIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">STDERR &quot;/var/log/err.log&quot; APPEND</span>
<span class="na">IO_REDIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">STDOUT &quot;/dev/null&quot;</span>
</pre></div>
</div>
<p>to silence stdout and log stderr, or</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">IO_REDIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">STDIN /opt/data/backup.tar</span>
<span class="na">IO_REDIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">STDOUT /opt/data/backup.tar.gz</span>
</pre></div>
</div>
<p>to read stdin from file and capture stdout to another file. Stderr will go to console as normal.</p>
<section id="named-pipes">
<h4>Named pipes<a class="headerlink" href="#named-pipes" title="Link to this heading">¶</a></h4>
<p>As indicated above, <code class="docutils literal notranslate"><span class="pre">crinit</span></code> also accepts the setting <code class="docutils literal notranslate"><span class="pre">PIPE</span></code> instead of <code class="docutils literal notranslate"><span class="pre">APPEND</span></code> or <code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code>. With this setting,
<code class="docutils literal notranslate"><span class="pre">crinit</span></code> will ensure that the given path is a named pipe (also called a FIFO special file). This is useful to pipe the
output of one task to another.</p>
<p>A common example would be redirection of output to syslog. For that we would create two task files, one as the sender
and another as the receiver (using the <code class="docutils literal notranslate"><span class="pre">logger</span></code> utility provided by e.g. busybox and others).</p>
<p><strong>Sending Task</strong></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">some_task</span>

<span class="na">COMMAND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/bin/echo &quot;This output will be redirected to syslog!&quot;</span>
<span class="na">RESPAWN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">NO</span>
<span class="na">DEPENDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="na">IO_REDIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">STDOUT &quot;/tmp/some_task_log_pipe&quot; PIPE 0640</span>
</pre></div>
</div>
<p><strong>Receiving Task</strong></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">some_task_logger</span>

<span class="na">COMMAND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/usr/bin/logger -t some_task</span>
<span class="na">RESPAWN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">YES</span>
<span class="na">DEPENDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="na">IO_REDIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">STDIN &quot;/tmp/some_task_log_pipe&quot; PIPE 0640</span>
</pre></div>
</div>
<p>This will redirect the output of the <code class="docutils literal notranslate"><span class="pre">echo</span></code> command to the input of the <code class="docutils literal notranslate"><span class="pre">logger</span></code> utility and thereby to syslog. As is
shown, it is also possible to set permissions for named pipes (default will also be <code class="docutils literal notranslate"><span class="pre">0644</span></code>). It should be kept in mind
to keep the permissions the same in both tasks. Setting different permissions in the sending and receiving task of a
pipe creates a race condition where one of the tasks will be able to create the named pipe with its settings. The other
task will take it as-is, as long as it can access the file.</p>
</section>
<section id="a-note-on-buffering">
<h4>A note on buffering<a class="headerlink" href="#a-note-on-buffering" title="Link to this heading">¶</a></h4>
<p>By default, glibc will switch from line- to block-buffered mode when redirecting a stream to file. This may make it
hard to use e.g. <code class="docutils literal notranslate"><span class="pre">tail</span> <span class="pre">-f</span> <span class="pre">...</span></code> to monitor the output in parallel. To get around that problem, one may use the <code class="docutils literal notranslate"><span class="pre">stdbuf</span></code>
utility (part of GNU coreutils).</p>
<p>In a <code class="docutils literal notranslate"><span class="pre">crinit</span></code> task, the following</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">line_buffered_task</span>

<span class="na">COMMAND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/usr/bin/stdbuf -oL -eL &lt;SOME_EXECUTABLE&gt;</span>

<span class="na">IO_REDIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">STDOUT &quot;/some/where.txt&quot;</span>
<span class="w">              </span><span class="na">STDERR &quot;/some/where/else.txt&quot;</span>
</pre></div>
</div>
<p>will result in line-buffered output to the files which can be monitored easily. For more details, see the <code class="docutils literal notranslate"><span class="pre">stdbuf</span></code> man
page.</p>
</section>
</section>
<section id="dependency-groups-meta-tasks">
<h3>Dependency groups (meta-tasks)<a class="headerlink" href="#dependency-groups-meta-tasks" title="Link to this heading">¶</a></h3>
<p>A dependency group or meta-task is a task without any <strong>COMMAND</strong>s. The provided dependencies of the meta-task will be
fulfilled immediately once its own dependencies are fulfilled. This can be used to semantically combine different
dependencies into one. Reasons to do that can be semantic readability of the configs or to provide hook dependencies
for third-party applications having an opaque view of their target system.</p>
<p>As an example a dependency group and a task using it could look like</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">dep_grp_server</span>

<span class="na">DEPENDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@provided:sql-db @provided:network @provided:firewall-open-port httpd:spawn</span>

<span class="na">PROVIDES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">server:wait</span>
</pre></div>
</div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">local_http_client</span>

<span class="na">COMMAND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/usr/bin/some-http-request localhost</span>

<span class="na">DEPENDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@provided:server</span>
<span class="c1"># or, with same effect: DEPENDS = dep_grp_server:wait</span>
</pre></div>
</div>
<p>Semantically, this would mean <code class="docutils literal notranslate"><span class="pre">local_http_client</span></code> only cares about the server, as a singular entity, being set up and
running. This could also be delivered by a third party with only the interface knowledge “You need to wait for the
<code class="docutils literal notranslate"><span class="pre">server</span></code> dependency”. How to provide this dependency, with which tasks, and in what order is then up to the system
integrator who maintains <code class="docutils literal notranslate"><span class="pre">dep_grp_server</span></code>.</p>
</section>
<section id="configuration-signatures">
<h3>Configuration Signatures<a class="headerlink" href="#configuration-signatures" title="Link to this heading">¶</a></h3>
<p>If compiled in (see <a class="reference internal" href="#build-instructions">Build Instructions</a>), Crinit supports checking signatures of its task and
global configuration files. The algorithm used is RSA-PSS using 4096 Bit keys and SHA256 hashing.</p>
<p>Crinit will use a root public key (named <code class="docutils literal notranslate"><span class="pre">crinit-root</span></code> as the searchable key description`) stored in the Kernel user
keyring and optionally downstream signed public keys stored in the rootfs. The downstream keys need to be signed using
the root key. Configuration files must then be signed either by the root key or by one of the downstream keys.</p>
<p>The root public key must be enrolled to the user keyring before Crinit starts. A common solution is to do this from a
signed initramfs, thereby leveraging a secure boot chain to establish trust in the key.</p>
<p>Signature checking is configured via the Kernel command line (also part of the trusted/secure boot chain) using these
two settings:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">crinit.signatures={yes,</span> <span class="pre">no}</span></code> - Activates signature checking if set to <code class="docutils literal notranslate"><span class="pre">yes</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">no</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">crinit.sigkeydir=&lt;path_to_downstream_keys&gt;</span></code> - Sets the path where Crinit searches for signed public keys in the
rootfs. Default is <code class="docutils literal notranslate"><span class="pre">/etc/crinit/pk</span></code>.</p></li>
</ul>
<p>For downstream keys and configuration files, Crinit expects a corresponding signature file with the <code class="docutils literal notranslate"><span class="pre">.sig</span></code> suffix to be
present in the same directory. As an example, the task file <code class="docutils literal notranslate"><span class="pre">very_valid.task</span></code> would need a signature file
<code class="docutils literal notranslate"><span class="pre">very_valid.task.sig</span></code> next to it. Key files may be in DER and PEM format with the appropriate filename extensions.
The <code class="docutils literal notranslate"><span class="pre">crinit-root</span></code> public key stored in the user keyring should be in DER binary format.</p>
<p>To prepare a system for using signatures and correctly signing files, the <code class="docutils literal notranslate"><span class="pre">scripts</span></code> directory contains</p>
<ul class="simple">
<li><p><strong>crinit-genkeys.sh</strong> to generate private signing keys and their public key counterparts.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Usage</span><span class="p">:</span> <span class="o">./</span><span class="n">crinit</span><span class="o">-</span><span class="n">genkeys</span><span class="o">.</span><span class="n">sh</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="o">/--</span><span class="n">help</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">k</span><span class="o">/--</span><span class="n">key</span><span class="o">-</span><span class="n">file</span> <span class="o">&lt;</span><span class="n">KEY_FILE</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">o</span><span class="o">/--</span><span class="n">output</span> <span class="o">&lt;</span><span class="n">OUTPUT_FILE</span><span class="o">&gt;</span><span class="p">]</span>
  <span class="n">If</span> <span class="n">no</span> <span class="n">other</span> <span class="n">arguments</span> <span class="n">are</span> <span class="n">given</span><span class="p">,</span> <span class="n">will</span> <span class="n">generate</span> <span class="n">an</span> <span class="n">RSA</span><span class="o">-</span><span class="mi">4096</span> <span class="n">private</span> <span class="n">key</span><span class="o">.</span> <span class="n">Alternatively</span> <span class="n">using</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">obtain</span>
  <span class="n">the</span> <span class="n">public</span> <span class="n">key</span> <span class="k">for</span> <span class="n">the</span> <span class="n">given</span> <span class="n">private</span> <span class="n">key</span><span class="o">.</span>
    <span class="o">-</span><span class="n">h</span><span class="o">/--</span><span class="n">help</span>
        <span class="o">-</span> <span class="n">Show</span> <span class="n">this</span> <span class="n">help</span><span class="o">.</span>
    <span class="o">-</span><span class="n">f</span><span class="o">/--</span><span class="nb">format</span>
        <span class="o">-</span> <span class="n">Choose</span> <span class="n">the</span> <span class="nb">format</span> <span class="n">of</span> <span class="n">the</span> <span class="n">output</span> <span class="n">file</span><span class="o">.</span> <span class="n">Must</span> <span class="n">be</span> <span class="n">either</span> <span class="s1">&#39;pem&#39;</span> <span class="ow">or</span> <span class="s1">&#39;der&#39;</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="s1">&#39;pem&#39;</span>
    <span class="o">-</span><span class="n">k</span><span class="o">/--</span><span class="n">key</span><span class="o">-</span><span class="n">file</span> <span class="o">&lt;</span><span class="n">KEY_FILE</span><span class="o">&gt;</span>
        <span class="o">-</span> <span class="n">Generate</span> <span class="n">a</span> <span class="n">public</span> <span class="n">key</span> <span class="kn">from</span><span class="w"> </span><span class="nn">the</span> <span class="n">given</span> <span class="n">private</span> <span class="n">key</span><span class="o">.</span> <span class="n">Use</span> <span class="s1">&#39;-&#39;</span> <span class="k">for</span> <span class="n">Standard</span> <span class="n">Input</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="n">Generate</span> <span class="n">a</span> <span class="n">private</span> <span class="n">key</span><span class="o">.</span>
    <span class="o">-</span><span class="n">o</span><span class="o">/--</span><span class="n">output</span> <span class="o">&lt;</span><span class="n">OUTPUT_FILE</span><span class="o">&gt;</span>
        <span class="o">-</span> <span class="n">The</span> <span class="n">filename</span> <span class="n">of</span> <span class="n">the</span> <span class="n">output</span> <span class="n">key</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="n">write</span> <span class="n">to</span> <span class="n">Standard</span> <span class="n">Output</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>crinit-sign.sh</strong> to sign files with a given private key.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Usage</span><span class="p">:</span> <span class="o">./</span><span class="n">crinit</span><span class="o">-</span><span class="n">sign</span><span class="o">.</span><span class="n">sh</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="o">/--</span><span class="n">help</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">k</span><span class="o">/--</span><span class="n">key</span><span class="o">-</span><span class="n">file</span> <span class="o">&lt;</span><span class="n">KEY_FILE</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">o</span><span class="o">/--</span><span class="n">output</span> <span class="o">&lt;</span><span class="n">OUTPUT_FILE</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">INPUT_FILE</span><span class="o">&gt;</span><span class="p">]</span>
  <span class="n">Will</span> <span class="n">sign</span> <span class="n">given</span> <span class="nb">input</span> <span class="n">data</span> <span class="k">with</span> <span class="n">an</span> <span class="n">RSA</span><span class="o">-</span><span class="n">PSS</span> <span class="n">signature</span> <span class="kn">from</span><span class="w"> </span><span class="nn">an</span> <span class="n">RSA</span><span class="o">-</span><span class="mi">4096</span> <span class="n">private</span> <span class="n">key</span> <span class="n">using</span> <span class="n">a</span> <span class="n">SHA</span><span class="o">-</span><span class="mi">256</span> <span class="nb">hash</span><span class="o">.</span>
    <span class="o">-</span><span class="n">h</span><span class="o">/--</span><span class="n">help</span>
        <span class="o">-</span> <span class="n">Show</span> <span class="n">this</span> <span class="n">help</span><span class="o">.</span>
    <span class="o">-</span><span class="n">k</span><span class="o">/--</span><span class="n">key</span><span class="o">-</span><span class="n">file</span> <span class="o">&lt;</span><span class="n">KEY_FILE</span><span class="o">&gt;</span>
        <span class="o">-</span> <span class="n">Use</span> <span class="n">the</span> <span class="n">given</span> <span class="n">private</span> <span class="n">key</span> <span class="n">to</span> <span class="n">sign</span><span class="o">.</span> <span class="n">Must</span> <span class="n">have</span> <span class="n">been</span> <span class="n">created</span> <span class="n">using</span> <span class="n">crinit</span><span class="o">-</span><span class="n">genkeys</span><span class="o">.</span><span class="n">sh</span><span class="o">.</span> <span class="p">(</span><span class="n">Mandatory</span><span class="p">)</span>
    <span class="o">-</span><span class="n">o</span><span class="o">/--</span><span class="n">output</span> <span class="o">&lt;</span><span class="n">OUTPUT_FILE</span><span class="o">&gt;</span>
        <span class="o">-</span> <span class="n">Write</span> <span class="n">signature</span> <span class="n">to</span> <span class="n">OUTPUT_FILE</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="n">Standard</span> <span class="n">Output</span>
    <span class="o">&lt;</span><span class="n">INPUT_FILE</span><span class="o">&gt;</span>
        <span class="o">-</span> <span class="n">Positional</span> <span class="n">argument</span><span class="o">.</span> <span class="n">The</span> <span class="nb">input</span> <span class="n">data</span> <span class="n">to</span> <span class="n">sign</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="n">Standard</span> <span class="n">Input</span>
</pre></div>
</div>
<p>Step by step instruction for a system with a root key and one downstream key would be:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">crinit-genkeys.sh</span> <span class="pre">-o</span> <span class="pre">crinit-root-priv.pem</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">generate</span> <span class="pre">private</span> <span class="pre">root</span> <span class="pre">key</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">crinit-genkeys.sh</span> <span class="pre">-f</span> <span class="pre">der</span> <span class="pre">-k</span> <span class="pre">crinit-root-pub.der</span>&#160;&#160; <span class="pre">#</span> <span class="pre">calculate</span> <span class="pre">public</span> <span class="pre">root</span> <span class="pre">key</span> <span class="pre">from</span> <span class="pre">it</span> <span class="pre">(destined</span> <span class="pre">for</span> <span class="pre">user</span> <span class="pre">keyring)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">crinit-genkeys.sh</span> <span class="pre">-o</span> <span class="pre">crinit-dwstr-priv.pem</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">generate</span> <span class="pre">downstream</span> <span class="pre">key</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">crinit-genkeys.sh</span> <span class="pre">-k</span> <span class="pre">crinit-root-pub.pem</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">calculate</span> <span class="pre">public</span> <span class="pre">key</span> <span class="pre">from</span> <span class="pre">it</span> <span class="pre">(destined</span> <span class="pre">for</span> <span class="pre">rootfs)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">crinit-sign.sh</span> <span class="pre">-k</span> <span class="pre">crinit-root-priv.pem</span> <span class="pre">-o</span> <span class="pre">crinit-dwstr-pub.pem.sig</span> <span class="pre">crinit-dwstr-pub.pem</span>&#160; <span class="pre">#</span> <span class="pre">sign</span> <span class="pre">downstream</span> <span class="pre">key</span> <span class="pre">with</span> <span class="pre">root</span> <span class="pre">key</span></code></p></li>
<li><p>Do step 5 for all configuration files crinit is expected to parse using either the root or the downstream key.</p></li>
</ol>
</section>
</section>
<section id="crinit-ctl-usage-info">
<h2>crinit-ctl Usage Info<a class="headerlink" href="#crinit-ctl-usage-info" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">crinit-ctl</span></code> is a CLI control program for <code class="docutils literal notranslate"><span class="pre">crinit</span></code> wrapping the client API functionality.</p>
<p>Below is its help output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">USAGE</span><span class="p">:</span> <span class="n">crinit</span><span class="o">-</span><span class="n">ctl</span> <span class="o">&lt;</span><span class="n">ACTION</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">OPTIONS</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">PARAMETER</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">PARAMETERS</span><span class="o">...</span><span class="p">]</span>
  <span class="n">where</span> <span class="n">ACTION</span> <span class="n">must</span> <span class="n">be</span> <span class="n">exactly</span> <span class="n">one</span> <span class="n">of</span> <span class="p">(</span><span class="n">including</span> <span class="n">specific</span> <span class="n">options</span><span class="o">/</span><span class="n">parameters</span><span class="p">):</span>
     <span class="n">addtask</span> <span class="p">[</span><span class="o">-</span><span class="n">f</span><span class="o">/--</span><span class="n">overwrite</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">i</span><span class="o">/--</span><span class="n">ignore</span><span class="o">-</span><span class="n">deps</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">d</span><span class="o">/--</span><span class="n">override</span><span class="o">-</span><span class="n">deps</span> <span class="s2">&quot;depA:eventA depB:eventB [...]&quot;</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">PATH</span><span class="o">&gt;</span>
             <span class="o">-</span> <span class="n">Will</span> <span class="n">add</span> <span class="n">a</span> <span class="n">task</span> <span class="n">defined</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">task</span> <span class="n">configuration</span> <span class="n">file</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">PATH</span><span class="o">&gt;</span> <span class="p">(</span><span class="n">absolute</span><span class="p">)</span> <span class="n">to</span> <span class="n">Crinit</span><span class="s1">&#39;s task database.</span>
               <span class="s1">&#39;-f/--overwrite&#39;</span> <span class="o">-</span> <span class="n">Lets</span> <span class="n">Crinit</span> <span class="n">know</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">fine</span> <span class="n">to</span> <span class="n">overwrite</span> <span class="k">if</span> <span class="n">it</span> <span class="n">has</span> <span class="n">already</span> <span class="n">loaded</span> <span class="n">a</span> <span class="n">task</span>
                    <span class="k">with</span> <span class="n">the</span> <span class="n">same</span> <span class="n">name</span><span class="o">.</span>
               <span class="s1">&#39;-d/--override-deps &lt;dependency-list&gt;&#39;</span> <span class="o">-</span> <span class="n">Will</span> <span class="n">override</span> <span class="n">the</span> <span class="n">DEPENDS</span> <span class="n">field</span> <span class="n">of</span> <span class="n">the</span> <span class="n">config</span> <span class="n">file</span>
                    <span class="k">with</span> <span class="n">what</span> <span class="ow">is</span> <span class="n">given</span> <span class="k">as</span> <span class="n">the</span> <span class="n">parameter</span><span class="o">.</span>
               <span class="s1">&#39;-i/--ignore-deps&#39;</span> <span class="o">-</span> <span class="n">Shortcut</span> <span class="k">for</span> <span class="s1">&#39;--override-deps &quot;&quot;&#39;</span><span class="o">.</span>
   <span class="n">addseries</span> <span class="p">[</span><span class="o">-</span><span class="n">f</span><span class="o">/--</span><span class="n">overwrite</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">PATH</span><span class="o">&gt;</span>
             <span class="o">-</span> <span class="n">Will</span> <span class="n">load</span> <span class="n">a</span> <span class="n">series</span> <span class="n">file</span> <span class="kn">from</span><span class="w"> </span><span class="o">&lt;</span><span class="n">PATH</span><span class="o">&gt;.</span> <span class="n">Options</span> <span class="nb">set</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">new</span> <span class="n">series</span> <span class="n">file</span> <span class="n">take</span> <span class="n">precedence</span> <span class="n">over</span>
               <span class="n">current</span> <span class="n">settings</span><span class="o">.</span>
               <span class="s1">&#39;-f/--overwrite&#39;</span> <span class="o">-</span> <span class="n">Lets</span> <span class="n">Crinit</span> <span class="n">know</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">fine</span> <span class="n">to</span> <span class="n">overwrite</span> <span class="k">if</span> <span class="n">it</span> <span class="n">has</span> <span class="n">already</span> <span class="n">loaded</span> <span class="n">tasks</span>
                    <span class="k">with</span> <span class="n">the</span> <span class="n">same</span> <span class="n">name</span> <span class="k">as</span> <span class="n">those</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">new</span> <span class="n">series</span> <span class="n">file</span><span class="o">.</span>
      <span class="n">enable</span> <span class="o">&lt;</span><span class="n">TASK_NAME</span><span class="o">&gt;</span>
             <span class="o">-</span> <span class="n">Removes</span> <span class="n">dependency</span> <span class="s1">&#39;@ctl:enable&#39;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">the</span> <span class="n">dependency</span> <span class="nb">list</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">TASK_NAME</span><span class="o">&gt;</span> <span class="k">if</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">present</span><span class="o">.</span>
     <span class="n">disable</span> <span class="o">&lt;</span><span class="n">TASK_NAME</span><span class="o">&gt;</span>
             <span class="o">-</span> <span class="n">Adds</span> <span class="n">dependency</span> <span class="s1">&#39;@ctl:enable&#39;</span> <span class="n">to</span> <span class="n">the</span> <span class="n">dependency</span> <span class="nb">list</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">TASK_NAME</span><span class="o">&gt;.</span>
        <span class="n">stop</span> <span class="o">&lt;</span><span class="n">TASK_NAME</span><span class="o">&gt;</span>
             <span class="o">-</span> <span class="n">If</span> <span class="n">the</span> <span class="n">task</span> <span class="n">has</span> <span class="n">a</span> <span class="n">STOP_COMMAND</span><span class="p">,</span> <span class="n">it</span> <span class="n">will</span> <span class="n">be</span> <span class="n">executed</span><span class="o">.</span> <span class="n">Otherwise</span><span class="p">,</span> <span class="n">Crinit</span> <span class="n">sends</span> <span class="n">SIGTERM</span> <span class="n">to</span> <span class="n">the</span>
               <span class="n">PID</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">TASK_NAME</span><span class="o">&gt;</span> <span class="k">if</span> <span class="n">the</span> <span class="n">PID</span> <span class="ow">is</span> <span class="n">currently</span> <span class="n">known</span><span class="o">.</span>
        <span class="n">kill</span> <span class="o">&lt;</span><span class="n">TASK_NAME</span><span class="o">&gt;</span>
             <span class="o">-</span> <span class="n">Sends</span> <span class="n">SIGKILL</span> <span class="n">to</span> <span class="n">the</span> <span class="n">PID</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">TASK_NAME</span><span class="o">&gt;</span> <span class="k">if</span> <span class="n">the</span> <span class="n">PID</span> <span class="ow">is</span> <span class="n">currently</span> <span class="n">known</span><span class="o">.</span>
     <span class="n">restart</span> <span class="o">&lt;</span><span class="n">TASK_NAME</span><span class="o">&gt;</span>
             <span class="o">-</span> <span class="n">Resets</span> <span class="n">the</span> <span class="n">status</span> <span class="n">bits</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">TASK_NAME</span><span class="o">&gt;</span> <span class="k">if</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">DONE</span> <span class="ow">or</span> <span class="n">FAILED</span><span class="o">.</span>
      <span class="n">status</span> <span class="o">&lt;</span><span class="n">TASK_NAME</span><span class="o">&gt;</span>
             <span class="o">-</span> <span class="n">Queries</span> <span class="n">status</span> <span class="n">bits</span><span class="p">,</span> <span class="n">PID</span><span class="p">,</span> <span class="ow">and</span> <span class="n">timestamps</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">TASK_NAME</span><span class="o">&gt;.</span> <span class="n">The</span> <span class="n">CTime</span><span class="p">,</span> <span class="n">STime</span><span class="p">,</span> <span class="ow">and</span> <span class="n">ETime</span> <span class="n">fields</span>
               <span class="n">represent</span> <span class="n">the</span> <span class="n">times</span> <span class="n">the</span> <span class="n">task</span> <span class="n">was</span> <span class="n">Created</span> <span class="p">(</span><span class="n">loaded</span><span class="o">/</span><span class="n">parsed</span><span class="p">),</span> <span class="n">last</span> <span class="n">Started</span> <span class="p">(</span><span class="n">became</span> <span class="n">running</span><span class="p">),</span> <span class="ow">and</span>
               <span class="n">last</span> <span class="n">Ended</span> <span class="p">(</span><span class="n">failed</span> <span class="ow">or</span> <span class="ow">is</span> <span class="n">done</span><span class="p">)</span><span class="o">.</span> <span class="n">If</span> <span class="n">the</span> <span class="n">event</span> <span class="n">has</span> <span class="ow">not</span> <span class="n">occurred</span> <span class="n">yet</span><span class="p">,</span> <span class="n">the</span> <span class="n">timestamp</span><span class="s1">&#39;s value will</span>
               <span class="n">be</span> <span class="s1">&#39;n/a&#39;</span><span class="o">.</span>
      <span class="n">notify</span> <span class="o">&lt;</span><span class="n">TASK_NAME</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="s2">&quot;SD_NOTIFY_STRING&quot;</span><span class="o">&gt;</span>
             <span class="o">-</span> <span class="n">Will</span> <span class="n">send</span> <span class="n">an</span> <span class="n">sd_notify</span><span class="o">-</span><span class="n">style</span> <span class="n">status</span> <span class="n">report</span> <span class="n">to</span> <span class="n">Crinit</span><span class="o">.</span> <span class="n">Only</span> <span class="n">MAINPID</span> <span class="ow">and</span> <span class="n">READY</span> <span class="n">are</span>
               <span class="n">implemented</span><span class="o">.</span> <span class="n">See</span> <span class="n">the</span> <span class="n">sd_notify</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">their</span> <span class="n">meaning</span><span class="o">.</span>
        <span class="nb">list</span>
             <span class="o">-</span> <span class="n">Print</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">loaded</span> <span class="n">tasks</span> <span class="ow">and</span> <span class="n">their</span> <span class="n">status</span><span class="o">.</span>
      <span class="n">reboot</span>
             <span class="o">-</span> <span class="n">Will</span> <span class="n">request</span> <span class="n">Crinit</span> <span class="n">to</span> <span class="n">perform</span> <span class="n">a</span> <span class="n">graceful</span> <span class="n">system</span> <span class="n">reboot</span><span class="o">.</span> <span class="n">crinit</span><span class="o">-</span><span class="n">ctl</span> <span class="n">can</span> <span class="n">be</span> <span class="n">symlinked</span> <span class="n">to</span>
               <span class="n">reboot</span> <span class="k">as</span> <span class="n">a</span> <span class="n">shortcut</span> <span class="n">which</span> <span class="n">will</span> <span class="n">invoke</span> <span class="n">this</span> <span class="n">command</span> <span class="n">automatically</span><span class="o">.</span>
    <span class="n">poweroff</span>
             <span class="o">-</span> <span class="n">Will</span> <span class="n">request</span> <span class="n">Crinit</span> <span class="n">to</span> <span class="n">perform</span> <span class="n">a</span> <span class="n">graceful</span> <span class="n">system</span> <span class="n">shutdown</span><span class="o">.</span> <span class="n">crinit</span><span class="o">-</span><span class="n">ctl</span> <span class="n">can</span> <span class="n">be</span> <span class="n">symlinked</span> <span class="n">to</span>
               <span class="n">poweroff</span> <span class="k">as</span> <span class="n">a</span> <span class="n">shortcut</span> <span class="n">which</span> <span class="n">will</span> <span class="n">invoke</span> <span class="n">this</span> <span class="n">command</span> <span class="n">automatically</span><span class="o">.</span>
  <span class="n">General</span> <span class="n">Options</span><span class="p">:</span>
        <span class="o">--</span><span class="n">verbose</span><span class="o">/-</span><span class="n">v</span> <span class="o">-</span> <span class="n">Be</span> <span class="n">verbose</span><span class="o">.</span>
        <span class="o">--</span><span class="n">help</span><span class="o">/-</span><span class="n">h</span>    <span class="o">-</span> <span class="n">Print</span> <span class="n">this</span> <span class="n">help</span><span class="o">.</span>
        <span class="o">--</span><span class="n">version</span><span class="o">/-</span><span class="n">V</span> <span class="o">-</span> <span class="n">Print</span> <span class="n">version</span> <span class="n">information</span> <span class="n">about</span> <span class="n">crinit</span><span class="o">-</span><span class="n">ctl</span><span class="p">,</span> <span class="n">the</span> <span class="n">crinit</span><span class="o">-</span><span class="n">client</span> <span class="n">library</span><span class="p">,</span>
                       <span class="ow">and</span> <span class="o">--</span> <span class="k">if</span> <span class="n">connection</span> <span class="ow">is</span> <span class="n">successful</span> <span class="o">--</span> <span class="n">the</span> <span class="n">crinit</span> <span class="n">daemon</span><span class="o">.</span>
</pre></div>
</div>
<p>As noted above, it will also make use of the <code class="docutils literal notranslate"><span class="pre">CRINIT_SOCK</span></code> environment variable to know which crinit socket to connect
to (Default: <code class="docutils literal notranslate"><span class="pre">/run/crinit/crinit.sock</span></code>).</p>
</section>
<section id="smart-bash-completion-for-crinit-ctl">
<h2>Smart bash completion for crinit-ctl<a class="headerlink" href="#smart-bash-completion-for-crinit-ctl" title="Link to this heading">¶</a></h2>
<p>There is a script to support smart bash completions for the crinit-ctl executable located at
<code class="docutils literal notranslate"><span class="pre">completion/crinit-ctl.bash</span></code>. On modern distributions, this file will need to be copied and renamed to
<code class="docutils literal notranslate"><span class="pre">/usr/share/bash-completion/completions/crinit-ctl</span></code> to be picked up automatically. The <code class="docutils literal notranslate"><span class="pre">cmake</span></code> installer can do this
(see below). Note that a fully bash-compatible shell (<code class="docutils literal notranslate"><span class="pre">bash</span></code>,<code class="docutils literal notranslate"><span class="pre">dash</span></code>) is required to take advantage of this.</p>
<p>For testing purposes, it is sufficient to run <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">completion/crinit-ctl.bash</span></code> to activate the smart completion for
the current session. The script can also be sourced from <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> if a system-wide installation is not desired.</p>
<p>Once installed and loaded, <code class="docutils literal notranslate"><span class="pre">crinit-ctl</span> <span class="pre">&lt;TAB&gt;&lt;TAB&gt;</span></code> will show/complete available command verbs like <code class="docutils literal notranslate"><span class="pre">addtask</span></code>, <code class="docutils literal notranslate"><span class="pre">enable</span></code>,
<code class="docutils literal notranslate"><span class="pre">disable</span></code>, etc. For <code class="docutils literal notranslate"><span class="pre">crinit-ctl</span> <span class="pre">addtask</span> <span class="pre">&lt;TAB&gt;&lt;TAB&gt;</span></code>, paths to <code class="docutils literal notranslate"><span class="pre">\*.crinit</span></code> files and specific options will be completed,
similar for <code class="docutils literal notranslate"><span class="pre">addseries</span></code>. Verbs taking a task name as input will have completion of available tasks loaded by crinit.
The script calls <code class="docutils literal notranslate"><span class="pre">crinit-ctl</span> <span class="pre">list</span></code> and parses its output in the background to achieve this.</p>
</section>
<section id="crinit-launch">
<h2>crinit-launch<a class="headerlink" href="#crinit-launch" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">crinit-launch</span></code> executable is a helper program to start a command as a different user and / or group. It is not
meant to be executed by the user directly.</p>
</section>
<section id="build-instructions">
<h2>Build Instructions<a class="headerlink" href="#build-instructions" title="Link to this heading">¶</a></h2>
<p>Executing</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>ci/docker-run.sh
</pre></div>
</div>
<p>will start a Docker container for the native host architecture with all necessary programs to build Crinit and its
Doxygen documentation and to run the tests.</p>
<p>It is possible to run the Docker container for a foreign architecture such as arm64 with the help of qemu-user-static
and binfmt-support. Make sure these packages are installed on your host system if you want to use this functionality.
All following commands to be run inside the container will be the same regardless of the architecture.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>ci/docker-run.sh<span class="w"> </span>arm64
</pre></div>
</div>
<p>By default, <code class="docutils literal notranslate"><span class="pre">ci/docker-run.sh</span></code> will use a container based on Ubuntu Jammy. If another version is desired, it can be
specified as a second parameter. For example, you can run a Lunar-based container using</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>ci/docker-run.sh<span class="w"> </span>amd64<span class="w"> </span>lunar
</pre></div>
</div>
<p>Inside the container, it is sufficient to run</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>ci/build.sh
</pre></div>
</div>
<p>which will compile the release configuration for <code class="docutils literal notranslate"><span class="pre">crinit</span></code>, the client library and crinit-ctl as well as a suite of RPMs.
The doxygen documentation is built as well. The script will copy relevant build artifacts to <code class="docutils literal notranslate"><span class="pre">result/</span></code>.</p>
<p>For debugging purposes, the debug configuration can be built with the following command. Optionally it is also possible
to enable AddressSanitizer (ASAN) for additional runtime checks or static analysis using <code class="docutils literal notranslate"><span class="pre">-fanalyzer</span></code> at compile-time.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>ci/build.sh<span class="w"> </span>Debug<span class="w"> </span>--asan<span class="w"> </span>--analyzer
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">clang-tidy</span></code> analysis of the source can be performed using</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>ci/clang-tidy.sh
</pre></div>
</div>
<p>This will also generate a <code class="docutils literal notranslate"><span class="pre">compile_commands.json</span></code>. The output will be saved to <code class="docutils literal notranslate"><span class="pre">result/clang-tidy</span></code>.</p>
<p>Unit tests or smoke tests can be run using the respective commands below. For the debug configuration, either of them
takes an additional <code class="docutils literal notranslate"><span class="pre">Debug</span></code> argument.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>ci/run-utest.sh
ci/run-smoketests.sh
</pre></div>
</div>
<p>In order to run integration tests, you can use <code class="docutils literal notranslate"><span class="pre">ci/run-integration-tests.sh</span></code>. This will set up two docker containers,
one for the Robot test framework and one that runs Crinit and Elos, and executes all integration tests inside the robot
container.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>ci/run-integration-tests.sh
</pre></div>
</div>
<p>You can also manually start both containers with <code class="docutils literal notranslate"><span class="pre">ci/docker-target-run.sh</span></code> and <code class="docutils literal notranslate"><span class="pre">ci/docker-integration-run.sh</span></code>.
Adapt the configuration within the robot container by changing the ip address of the target container within the robot
variables (<code class="docutils literal notranslate"><span class="pre">test/integration/robot_variables.py</span></code>) to the current ip of the target container and run the tests by
executing <code class="docutils literal notranslate"><span class="pre">test/integration/scripts/run-integration-tests.sh</span></code> inside the robot container.</p>
<p>If a manual test build is desired, running the following command sequence
inside the container will setup the build system and build native binaries.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>-p<span class="w"> </span>build/amd64
cmake<span class="w"> </span>-B<span class="w"> </span>build/amd64<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>Debug<span class="w"> </span>-DCMAKE_VERBOSE_MAKEFILE<span class="o">=</span>On<span class="w"> </span>-DUNIT_TESTS<span class="o">=</span>On
make<span class="w"> </span>-C<span class="w"> </span>build/amd64
</pre></div>
</div>
<p>Some default paths can be configured on compile time:</p>
<ul class="simple">
<li><p>Default series file: <code class="docutils literal notranslate"><span class="pre">-DDEFAULT_CONFIG_SERIES_FILE</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">$CMAKE_INSTALL_SYSCONFDIR/crinit/default.series</span></code>.</p></li>
<li><p>Default location of the client communication socket: <code class="docutils literal notranslate"><span class="pre">-DDEFAULT_CRINIT_SOCKFILE=&lt;FILEPATH&gt;</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">$CMAKE_INSTALL_RUNSTATEDIR/crinit/crinit.sock</span></code>.</p></li>
<li><p>Default include directory: <code class="docutils literal notranslate"><span class="pre">-DDEFAULT_INCL_DIR=&lt;PATH&gt;</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">$CMAKE_INSTALL_SYSCONFDIR/crinit</span></code>.</p></li>
<li><p>Default task directory: <code class="docutils literal notranslate"><span class="pre">-DDEFAULT_TASK_DIR=&lt;PATH&gt;</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">$CMAKE_INSTALL_SYSCONFDIR/crinit</span></code>.</p></li>
</ul>
<p>The cmake setup supports some optional features:</p>
<ul class="simple">
<li><p>Crinit signature support using <code class="docutils literal notranslate"><span class="pre">-DENABLE_SIGNATURE_SUPPORT={On,</span> <span class="pre">Off}</span></code>. If set to on, crinit will have a dependency to
<a class="reference external" href="https://github.com/Mbed-TLS/mbedtls">libmbedtls</a>. Default is <code class="docutils literal notranslate"><span class="pre">On</span></code>.</p></li>
<li><p>Configurable default path of signed (downstream) public keys <code class="docutils literal notranslate"><span class="pre">-DDEFAULT_SIGKEY_DIR=&lt;PATH&gt;</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">$CMAKE_INSTALL_SYSCONFDIR/crinit/pk</span></code>.</p></li>
<li><p>Crinit ELOS support using <code class="docutils literal notranslate"><span class="pre">-DENABLE_ELOS={On,</span> <span class="pre">Off}</span></code>. If set to on, crinit will have a dependency to
<a class="reference external" href="https://github.com/elektrobit/safu">safu</a>. Default is <code class="docutils literal notranslate"><span class="pre">On</span></code>.</p></li>
<li><p>Unit tests using <code class="docutils literal notranslate"><span class="pre">-DUNIT_TESTS={On,</span> <span class="pre">Off}</span></code>. If set to on, Crinit’s unit tests will be built and installed to
<code class="docutils literal notranslate"><span class="pre">UNIT_TEST_INSTALL_DIR</span></code>. This will cause a dependency to cmocka 1.1.5 or greater. Default is <code class="docutils literal notranslate"><span class="pre">On</span></code> with installation
path <code class="docutils literal notranslate"><span class="pre">${CMAKE_INSTALL_LIBDIR}/test/crinit/utest</span></code>.</p></li>
<li><p>Elos event polling time (see global configuration example) <code class="docutils literal notranslate"><span class="pre">-DDEFAULT_ELOS_EVENT_POLLING_TIME=&lt;usecs&gt;</span></code>.
Default is 500000.</p></li>
<li><p>Build and install API documentation in doxygen HTML format using <code class="docutils literal notranslate"><span class="pre">-DAPI_DOC={On,</span> <span class="pre">Off}</span></code>. Needs doxygen. Default is
<code class="docutils literal notranslate"><span class="pre">On</span></code>.</p></li>
<li><p>Build and install an example generator for the machine id file (see above) using <code class="docutils literal notranslate"><span class="pre">-DMACHINE_ID_EXAMPLE={On,</span> <span class="pre">Off}</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">Off</span></code>.</p></li>
<li><p>Name and path for the machine id file: <code class="docutils literal notranslate"><span class="pre">-DDEFAULT_MACHINE_ID_FILE=&lt;FILEPATH&gt;</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">$CMAKE_INSTALL_SYSCONFDIR/machine-id</span></code>.</p></li>
<li><p>Install the example configurations from <code class="docutils literal notranslate"><span class="pre">config/example</span></code> to <code class="docutils literal notranslate"><span class="pre">/etc/${EXAMPLE_TASKDIR}</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">Off</span></code>, default
installation path is <code class="docutils literal notranslate"><span class="pre">/etc/crinit/example</span></code>.</p></li>
<li><p>Install the smoke test scripts and configurations, using <code class="docutils literal notranslate"><span class="pre">-DINSTALL_SMOKE_TESTS={On,</span> <span class="pre">Off}</span></code>, to the
<code class="docutils literal notranslate"><span class="pre">SMOKE_TEST_SCRIPT_DIR</span></code> and <code class="docutils literal notranslate"><span class="pre">SMOKE_TEST_CONF_DIR</span></code>, respectively. Default is <code class="docutils literal notranslate"><span class="pre">Off</span></code> and default installation paths are
<code class="docutils literal notranslate"><span class="pre">${CMAKE_INSTALL_LIBDIR}/test/crinit/smoketest</span></code> and <code class="docutils literal notranslate"><span class="pre">${CMAKE_INSTALL_LIBDIR}/test/crinit/smoketest/config</span></code>.</p></li>
<li><p>Install the necessary resources for a robot test target system using <code class="docutils literal notranslate"><span class="pre">-DINSTALL_ROBOT_TEST_RESOURCES={On,</span> <span class="pre">Off}</span></code> to
<code class="docutils literal notranslate"><span class="pre">ROBOT_TEST_RESOURCE_DIR</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">Off</span></code> and default install path is <code class="docutils literal notranslate"><span class="pre">${CMAKE_INSTALL_SYSCONFDIR}/crinit/itest</span></code>.</p></li>
<li><p>Set the installation path for the symbolic links for <code class="docutils literal notranslate"><span class="pre">reboot</span></code> and <code class="docutils literal notranslate"><span class="pre">poweroff</span></code> using <code class="docutils literal notranslate"><span class="pre">PWR_SYMLINKS_PATH</span></code>. Default is
<code class="docutils literal notranslate"><span class="pre">${CMAKE_INSTALL_PREFIX}/${CMAKE_INSTALL_SBINDIR}</span></code></p></li>
<li><p>Install the bash completion script for crinit-ctl, using <code class="docutils literal notranslate"><span class="pre">-DINSTALL_BASH_COMPLETION={On,</span> <span class="pre">Off}</span></code>, to the
<code class="docutils literal notranslate"><span class="pre">BASH_COMPLETION_DIR</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">On</span></code> and default isntall path is
<code class="docutils literal notranslate"><span class="pre">${CMAKE_INSTALL_DATADIR/bash-completion/completions</span></code>.</p></li>
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">SONAME</span></code> of libelos crinit will try to open at run-time. Default is auto-detection if elos is present in the
build environment or <code class="docutils literal notranslate"><span class="pre">libelos.so.1</span></code> if it is not.</p></li>
</ul>
</section>
<section id="build-requirements">
<h2>Build Requirements<a class="headerlink" href="#build-requirements" title="Link to this heading">¶</a></h2>
<p>In order to build crinit, some prerequisites have to be installed.</p>
<ul class="simple">
<li><p>a modern GCC toolchain with C17 support</p></li>
<li><p>cmake &gt;= 3.21</p></li>
<li><p>re2c &gt;= 3.0</p></li>
<li><p>optional, for ELOS support: <a class="reference external" href="https://github.com/elektrobit/safu">safu</a> &gt;= 0.58.2</p></li>
<li><p>optional, for signature support: <a class="reference external" href="https://github.com/Mbed-TLS/mbedtls">MbedTLS</a> 2.28.x or 3.x</p></li>
<li><p>optional, for unit tests: cmocka &gt;= 1.1.5</p></li>
<li><p>optional, for HTML API documentation: Doxygen</p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/crinit_logo_blk.svg" alt="Logo of crinit"/>
            </a></p>
<h1 class="logo"><a href="index.html">crinit</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">README manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="#in-a-nutshell">In a Nutshell</a></li>
<li class="toctree-l2"><a class="reference internal" href="#concept">Concept</a></li>
<li class="toctree-l2"><a class="reference internal" href="#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="#powered-by-eb">Powered by EB</a></li>
<li class="toctree-l2"><a class="reference internal" href="#maintainers">Maintainers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#credits">Credits</a></li>
<li class="toctree-l2"><a class="reference internal" href="#artwork">Artwork</a></li>
<li class="toctree-l2"><a class="reference internal" href="#command-line-options">Command-line options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#crinit-ctl-usage-info">crinit-ctl Usage Info</a></li>
<li class="toctree-l2"><a class="reference internal" href="#smart-bash-completion-for-crinit-ctl">Smart bash completion for crinit-ctl</a></li>
<li class="toctree-l2"><a class="reference internal" href="#crinit-launch">crinit-launch</a></li>
<li class="toctree-l2"><a class="reference internal" href="#build-instructions">Build Instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#build-requirements">Build Requirements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="API-Doc.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/README.html">Helper Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="ci/index.html">CI/CD Tooling</a></li>
<li class="toctree-l1"><a class="reference internal" href="doc/adr/index.html">ADRs</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Crinit – Configurable Rootfs Init</a></li>
      <li>Next: <a href="API-Doc.html" title="next chapter">API Documentation</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023, emlix GmbH/Elektrobit Automotive GmbH.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/README.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>